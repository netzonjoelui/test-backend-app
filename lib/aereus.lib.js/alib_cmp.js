var AJAX_POST=1;var AJAX_GET=2;var AJAX_NODE_TEXT=3;var AJAX_NODE_HTML=1;var AJAX_TRACE_RESPONSE=false;function CAjax(){this.m_xmlLocal=null;this.m_response=null;this.m_firstNode=null;this.m_method=AJAX_GET;if(window.XMLHttpRequest){this.m_xmlLocal=new XMLHttpRequest()}else{var msxmlhttp=new Array('Msxml2.XMLHTTP.5.0','Msxml2.XMLHTTP.4.0','Msxml2.XMLHTTP.3.0','Msxml2.XMLHTTP','Microsoft.XMLHTTP');for(var i=0;i<msxmlhttp.length;i++){try{this.m_xmlLocal=new ActiveXObject(msxmlhttp[i])}catch(e){this.m_xmlLocal=null}}}}CAjax.prototype.exec=function(url,args,async){var is_async=(async!=null)?async:true;var post_data=null;var xmlLocal=this.m_xmlLocal;var objref=this;if(is_async==true){function inlineLoaded(){if(xmlLocal&&xmlLocal.readyState==4){if(xmlLocal.status==200){if(xmlLocal.responseXML==null){if(ALib.m_debug==true){ALib.trace("XML Failed: "+xmlLocal.responseText)}}else if(xmlLocal.responseXML.documentElement==null){if(ALib.m_debug==true){ALib.trace("XML Failed: "+xmlLocal.responseText)}}else{if(AJAX_TRACE_RESPONSE)ALib.trace("Response: "+xmlLocal.responseText);objref.m_response=xmlLocal.responseXML.documentElement;objref.m_firstNode=new CAjaxNode("root","");objref.m_firstNode.m_xmlcld=objref.m_response;objref.parseNodes(objref.m_firstNode,objref.m_response)}objref.responseText=xmlLocal.responseText;objref.onload();objref=null}}}this.m_xmlLocal.onreadystatechange=inlineLoaded}if(this.m_method==AJAX_GET){this.m_xmlLocal.open("GET",url,is_async)}else if(this.m_method==AJAX_POST){var numargs=0;if(typeof args!="undefined"&&args){numargs=args.length;if(numargs){for(i=0;i<numargs;i++){if(post_data)post_data+="&";else post_data="";post_data+=args[i][0]+"=";if(typeof args[i][1]!="undefined"&&args[i][1]!=null)post_data+=escape_utf8(args[i][1])}}}this.m_xmlLocal.open("POST",url,is_async);this.m_xmlLocal.setRequestHeader("Content-type","application/x-www-form-urlencoded")}if(is_async==false){this.parseXml()}this.m_xmlLocal.send(post_data)}CAjax.prototype.readyStateChange=function(){var xmlLocal=this.m_xmlLocal;if(xmlLocal&&xmlLocal.readyState==4){if(xmlLocal.status==200){this.m_response=xmlLocal.responseXML.documentElement;this.m_firstNode=new CAjaxNode(this.m_firstNode.nodeName,"");this.m_firstNode.m_type=AJAX_NODE_HTML;this.parseNodes(this.m_firstNode,m_response);this.onload()}}}CAjax.prototype.parseXml=function(){var xmlLocal=this.m_xmlLocal;alert(xmlLocal);alert(xmlLocal.status);if(xmlLocal.status==200){this.m_response=xmlLocal.responseXML.documentElement;this.m_firstNode=new CAjaxNode("root","");this.parseNodes(this.m_firstNode,this.m_response)}}CAjax.prototype.parseNodes=function(ajax_node,xml_child){if(!ajax_node||!xml_child)return 0;var iNumSubNodes=ajax_node.m_children.length;var children=xml_child.childNodes;var iNewIndex=0;if(children){var num=children.length;for(var i=0;i<num;i++){var child=children[i];if(child.nodeType==AJAX_NODE_HTML){ajax_node.m_children[iNumSubNodes+iNewIndex]=new CAjaxNode(child.nodeName,"");ajax_node.m_children[iNumSubNodes+iNewIndex].m_xmlcld=child;if(child.childNodes&&child.childNodes.length)this.parseNodes(ajax_node.m_children[iNumSubNodes+iNewIndex],child);iNewIndex++}if(child.nodeType==AJAX_NODE_TEXT){ajax_node.m_text+=child.nodeValue}}}}CAjax.prototype.onload=function(){}function CAjaxNode(name,text){this.m_name=name;this.m_text=text;this.m_attributes=new Array();this.m_children=new Array()}CAjaxNode.prototype.getNumChildren=function(){if(this.m_children)return this.m_children.length;else return 0}CAjaxNode.prototype.getChildNode=function(iIndex){return this.m_children[iIndex]}CAjaxNode.prototype.getChildNodesByName=function(name){if(this.m_query_res&&this.m_query_res.length)delete this.m_query_res;this.m_query_res=new Array();var num=this.getNumChildren();var iFound=0;for(i=0;i<num;i++){if(this.getChildNode(i).m_name==name){this.m_query_res[iFound]=this.getChildNode(i);iFound++}}return this.m_query_res}CAjaxNode.prototype.getChildNodeByName=function(name){var val=null;for(var p=0;p<this.getNumChildren();p++){if(this.getChildNode(p).m_name==name){val=this.getChildNode(p);break}}return val}CAjaxNode.prototype.getChildNodeValByName=function(name){var val=null;for(var p=0;p<this.getNumChildren();p++){if(this.getChildNode(p).m_name==name){val=this.getChildNode(p).m_text;break}}return val}CAjaxNode.prototype.getAttribute=function(name){return unescape(this.m_xmlcld.getAttribute(name))}var g_CAjaxRpc=new Array();function CAjaxRpc(url,f_name,args,finished_cb,cb_args,method){var send_method=(method)?method:AJAX_GET;var ind=g_CAjaxRpc.length;g_CAjaxRpc[ind]=new CAjax();g_CAjaxRpc[ind].m_method=send_method;if(typeof cb_args!="undefined")g_CAjaxRpc[ind].m_cb_args=cb_args;else g_CAjaxRpc[ind].m_cb_args=null;g_CAjaxRpc[ind].onload=function(){var retval=null;var root=this.m_firstNode;var num=root.getNumChildren();if(num){for(i=0;i<num;i++){var child=root.getChildNode(i);if(child.m_name=="retval"){if(child.m_text)retval=unescape(child.m_text)}}if(this.cb_function){try{if(typeof this.cb_function=="string"){if(this.m_cb_args){var passargs="\""+retval+"\"";for(var j=0;j<m_cb_args.length;j++){passargs+=", \""+m_cb_args[j]+"\""}eval(this.cb_function+"("+passargs+")")}else{eval(this.cb_function+"(\""+retval+"\")")}}else{if(this.m_cb_args){switch(this.m_cb_args.length){case 1:this.cb_function(retval,this.m_cb_args[0]);break;case 2:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1]);break;case 3:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2]);break;case 4:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3]);break;case 5:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4]);break;case 6:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5]);break;case 7:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6]);break;case 8:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7]);break;case 9:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7],this.m_cb_args[8]);break;case 10:this.cb_function(retval,this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7],this.m_cb_args[8],this.m_cb_args[9]);break}}else{this.cb_function(retval)}}}catch(e){}}}CAjaxRpcCleanup(this)};var exec_url=url;exec_url+="?function="+f_name;if(finished_cb)g_CAjaxRpc[ind].cb_function=finished_cb;if(send_method==AJAX_POST&&typeof args!="undefined"){g_CAjaxRpc[ind].exec(exec_url,args)}else{if(typeof args!="undefined"&&args){var numargs=args.length;if(numargs){for(i=0;i<numargs;i++){exec_url+="&"+args[i][0]+"="+escape_utf8(args[i][1])}}}g_CAjaxRpc[ind].exec(exec_url)}}function CAjaxRpcCleanup(ref){var num=g_CAjaxRpc.length;for(i=0;i<num;i++){if(g_CAjaxRpc[i]==ref){g_CAjaxRpc[i]=null}}}function CBrowserInfo(){var agt=navigator.userAgent.toLowerCase();this.major=parseInt(navigator.appVersion);this.minor=parseFloat(navigator.appVersion);this.nav=((agt.indexOf('mozilla')!=-1)&&(agt.indexOf('spoofer')==-1)&&(agt.indexOf('compatible')==-1)&&(agt.indexOf('opera')==-1)&&(agt.indexOf('webtv')==-1)&&(agt.indexOf('hotjava')==-1));this.nav2=(this.nav&&(this.major==2));this.nav3=(this.nav&&(this.major==3));this.nav4=(this.nav&&(this.major==4));this.nav4up=(this.nav&&(this.major>=4));this.navonly=(this.nav&&((agt.indexOf(";nav")!=-1)||(agt.indexOf("; nav")!=-1)));this.nav6=(this.nav&&(this.major==5));this.nav6up=(this.nav&&(this.major>=5));this.gecko=(agt.indexOf('gecko')!=-1);this.ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));this.ie3=(this.ie&&(this.major<4));this.ie4=(this.ie&&(this.major==4)&&(agt.indexOf("msie 4")!=-1));this.ie4up=(this.ie&&(this.major>=4));this.ie5=(this.ie&&(this.major==4)&&(agt.indexOf("msie 5.0")!=-1));this.ie5_5=(this.ie&&(this.major==4)&&(agt.indexOf("msie 5.5")!=-1));this.ie5up=(this.ie&&!this.ie3&&!this.ie4);this.ie5_5up=(this.ie&&!this.ie3&&!this.ie4&&!this.ie5);this.ie6=(this.ie&&(this.major==4)&&(agt.indexOf("msie 6.")!=-1));this.ie6up=(this.ie&&!this.ie3&&!this.ie4&&!this.ie5&&!this.ie5_5&&!this.ie6);this.ie7=(this.ie&&(this.major==4)&&(agt.indexOf("msie 7.")!=-1));this.ie7up=(this.ie&&!this.ie3&&!this.ie4&&!this.ie5&&!this.ie5_5&&!this.ie6);this.aol=(agt.indexOf("aol")!=-1);this.aol3=(this.aol&&this.ie3);this.aol4=(this.aol&&this.ie4);this.aol5=(agt.indexOf("aol 5")!=-1);this.aol6=(agt.indexOf("aol 6")!=-1);this.opera=(agt.indexOf("opera")!=-1);this.opera2=(agt.indexOf("opera 2")!=-1||agt.indexOf("opera/2")!=-1);this.opera3=(agt.indexOf("opera 3")!=-1||agt.indexOf("opera/3")!=-1);this.opera4=(agt.indexOf("opera 4")!=-1||agt.indexOf("opera/4")!=-1);this.opera5=(agt.indexOf("opera 5")!=-1||agt.indexOf("opera/5")!=-1);this.opera5up=(this.opera&&!this.opera2&&!this.opera3&&!this.opera4);this.webtv=(agt.indexOf("webtv")!=-1);this.TVNavigator=((agt.indexOf("navio")!=-1)||(agt.indexOf("navio_aoltv")!=-1));this.AOLTV=this.TVNavigator;this.hotjava=(agt.indexOf("hotjava")!=-1);this.hotjava3=(this.hotjava&&(this.major==3));this.hotjava3up=(this.hotjava&&(this.major>=3));if(this.nav2||this.ie3)this.js=1.0;else if(this.nav3)this.js=1.1;else if(this.opera5up)this.js=1.3;else if(this.opera)this.js=1.1;else if((this.nav4&&(this.minor<=4.05))||this.ie4)this.js=1.2;else if((this.nav4&&(this.minor>4.05))||this.ie5)this.js=1.3;else if(this.hotjava3up)this.js=1.4;else if(this.nav6||this.gecko)this.js=1.5;else if(this.nav6up)this.js=1.5;else if(this.ie5up)this.js=1.3 else this.js=0.0;this.win=((agt.indexOf("win")!=-1)||(agt.indexOf("16bit")!=-1));this.win95=((agt.indexOf("win95")!=-1)||(agt.indexOf("windows 95")!=-1));this.win16=((agt.indexOf("win16")!=-1)||(agt.indexOf("16bit")!=-1)||(agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("windows 16-bit")!=-1));this.win31=((agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("win16")!=-1)||(agt.indexOf("windows 16-bit")!=-1));this.win98=((agt.indexOf("win98")!=-1)||(agt.indexOf("windows 98")!=-1));this.winnt=((agt.indexOf("winnt")!=-1)||(agt.indexOf("windows nt")!=-1));this.win32=(this.win95||this.winnt||this.win98||((this.major>=4)&&(navigator.platform=="Win32"))||(agt.indexOf("win32")!=-1)||(agt.indexOf("32bit")!=-1));this.winme=((agt.indexOf("win 9x 4.90")!=-1));this.win2k=((agt.indexOf("windows nt 5.0")!=-1));this.winxp=((agt.indexOf("windows nt 5.1")!=-1));this.winvista=((agt.indexOf("windows nt 6.0")!=-1));this.os2=((agt.indexOf("os/2")!=-1)||(navigator.appVersion.indexOf("OS/2")!=-1)||(agt.indexOf("ibm-webexplorer")!=-1));this.mac=(agt.indexOf("mac")!=-1);if(this.mac&&this.ie5up)this.js=1.4;this.mac68k=(this.mac&&((agt.indexOf("68k")!=-1)||(agt.indexOf("68000")!=-1)));this.macppc=(this.mac&&((agt.indexOf("ppc")!=-1)||(agt.indexOf("powerpc")!=-1)));this.sun=(agt.indexOf("sunos")!=-1);this.sun4=(agt.indexOf("sunos 4")!=-1);this.sun5=(agt.indexOf("sunos 5")!=-1);this.suni86=(this.sun&&(agt.indexOf("i86")!=-1));this.irix=(agt.indexOf("irix")!=-1);this.irix5=(agt.indexOf("irix 5")!=-1);this.irix6=((agt.indexOf("irix 6")!=-1)||(agt.indexOf("irix6")!=-1));this.hpux=(agt.indexOf("hp-ux")!=-1);this.hpux9=(this.hpux&&(agt.indexOf("09.")!=-1));this.hpux10=(this.hpux&&(agt.indexOf("10.")!=-1));this.aix=(agt.indexOf("aix")!=-1);this.aix1=(agt.indexOf("aix 1")!=-1);this.aix2=(agt.indexOf("aix 2")!=-1);this.aix3=(agt.indexOf("aix 3")!=-1);this.aix4=(agt.indexOf("aix 4")!=-1);this.linux=(agt.indexOf("inux")!=-1);this.sco=(agt.indexOf("sco")!=-1)||(agt.indexOf("unix_sv")!=-1);this.unixware=(agt.indexOf("unix_system_v")!=-1);this.mpras=(agt.indexOf("ncr")!=-1);this.reliant=(agt.indexOf("reliantunix")!=-1);this.dec=((agt.indexOf("dec")!=-1)||(agt.indexOf("osf1")!=-1)||(agt.indexOf("dec_alpha")!=-1)||(agt.indexOf("alphaserver")!=-1)||(agt.indexOf("ultrix")!=-1)||(agt.indexOf("alphastation")!=-1));this.sinix=(agt.indexOf("sinix")!=-1);this.freebsd=(agt.indexOf("freebsd")!=-1);this.bsd=(agt.indexOf("bsd")!=-1);this.unix=((agt.indexOf("x11")!=-1)||this.sun||this.irix||this.hpux||this.sco||this.unixware||this.mpras||this.reliant||this.dec||this.sinix||this.aix||this.linux||this.bsd||this.freebsd);this.vms=((agt.indexOf("vax")!=-1)||(agt.indexOf("openvms")!=-1))}function CButton(title,funct,args,scheme,width,mouseover,mouseout){scheme=(scheme)?scheme:'b1';this.m_scheme=scheme;this.m_main=ALib.m_document.createElement("div");ALib.Dom.styleSet(this.m_main,"float","left");var table=ALib.m_document.createElement("table");this.m_main.appendChild(table);ALib.Dom.styleSetClass(table,"CButton_"+scheme);table.setAttribute("cellpadding","0");table.cellPadding="0";table.setAttribute("cellspacing","0");table.cellSpacing="0";var tbody=ALib.m_document.createElement("tbody");table.appendChild(tbody);var tr=ALib.m_document.createElement("tr");this.m_tl=ALib.m_document.createElement("td");tr.appendChild(this.m_tl);this.m_tc=ALib.m_document.createElement("td");tr.appendChild(this.m_tc);this.m_tr=ALib.m_document.createElement("td");tr.appendChild(this.m_tr);tbody.appendChild(tr);var tr=ALib.m_document.createElement("tr");this.m_l=ALib.m_document.createElement("td");tr.appendChild(this.m_l);this.m_c=ALib.m_document.createElement("td");this.m_c.m_btnh=this;this.m_c.innerHTML=title;this.m_c.style.whiteSpace="nowrap";tr.appendChild(this.m_c);this.m_r=ALib.m_document.createElement("td");tr.appendChild(this.m_r);tbody.appendChild(tr);var tr=ALib.m_document.createElement("tr");this.m_bl=ALib.m_document.createElement("td");tr.appendChild(this.m_bl);this.m_bc=ALib.m_document.createElement("td");tr.appendChild(this.m_bc);this.m_br=ALib.m_document.createElement("td");tr.appendChild(this.m_br);tbody.appendChild(tr);this.m_c.onmouseover=function(){this.m_btnh.changeState("over")}this.m_c.onmouseout=function(){this.m_btnh.changeState("out")}this.m_c.m_funct=funct;this.m_c.m_args=args;this.m_c.onclick=function(){if(typeof this.m_funct=="string")eval(this.m_funct);else{if(this.m_args){switch(this.m_args.length){case 1:this.m_funct(this.m_args[0]);break;case 2:this.m_funct(this.m_args[0],this.m_args[1]);break;case 3:this.m_funct(this.m_args[0],this.m_args[1],this.m_args[2]);break;case 4:this.m_funct(this.m_args[0],this.m_args[1],this.m_args[2],this.m_args[3]);break}}else this.m_funct()}}this.m_table=table;this.changeState("out")}CButton.prototype.changeState=function(state){switch(state){case'over':ALib.Dom.styleSetClass(this.m_tl,"CButtonTopLeft_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_tc,"CButtonTopCenter_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_tr,"CButtonTopRight_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_l,"CButtonBodyLeft_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_c,"CButtonBody_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_r,"CButtonBodyRight_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_bl,"CButtonBottomLeft_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_bc,"CButtonBottomCenter_"+this.m_scheme+"Over");ALib.Dom.styleSetClass(this.m_br,"CButtonBottomRight_"+this.m_scheme+"Over");break;case'out':ALib.Dom.styleSetClass(this.m_tl,"CButtonTopLeft_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_tc,"CButtonTopCenter_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_tr,"CButtonTopRight_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_l,"CButtonBodyLeft_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_c,"CButtonBody_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_r,"CButtonBodyRight_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_bl,"CButtonBottomLeft_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_bc,"CButtonBottomCenter_"+this.m_scheme);ALib.Dom.styleSetClass(this.m_br,"CButtonBottomRight_"+this.m_scheme);break}}CButton.prototype.getButton=function(){return this.m_main}CButton.prototype.print=function(con){con.appendChild(this.m_main)}CButton.prototype.getTable=function(){return this.m_table}function CContentTable(title,width,height){var table=ALib.m_document.createElement("table");this.m_table=table;table.className="ContentTable";table.setAttribute("cellpadding","0");table.cellSpacing="0";table.setAttribute("cellspacing","0");table.cellPadding="0";table.setAttribute("border","0");table.border="0";if(width){this.m_width=width;ALib.Dom.styleSet(table,"width",width)}if(height)table.style.height=height;var tbl_body=ALib.m_document.createElement("TBODY")var row=ALib.m_document.createElement("tr");var td_left=ALib.m_document.createElement("td");td_left.className="ContentTableTitleLeftCorn";row.appendChild(td_left);var td_middle=ALib.m_document.createElement("td");td_middle.className="ContentTableTitleCenter";this.m_spTitle=ALib.m_document.createElement("div");this.m_spTitle.className="ContentTableTitleLabel";ALib.Dom.styleSet(this.m_spTitle,"float","left");this.m_spTitle.innerHTML=title;td_middle.appendChild(this.m_spTitle);this.m_context=ALib.m_document.createElement("div");ALib.Dom.styleSet(this.m_context,"float","right");this.m_context.className='ContentTableTitleContext';td_middle.appendChild(this.m_context);row.appendChild(td_middle);var td_right=ALib.m_document.createElement("td");td_right.className="ContentTableTitleRightCorn";row.appendChild(td_right);tbl_body.appendChild(row);var row=ALib.m_document.createElement("tr");row.vAlign="top";row.setAttribute("valign","top");var td_left=ALib.m_document.createElement("td");td_left.className="ContentTableBodyLeft";row.appendChild(td_left);var divContent=ALib.m_document.createElement("td");divContent.className="ContentTableBody";row.appendChild(divContent);var td_right=ALib.m_document.createElement("td");td_right.className="ContentTableBodyRight";row.appendChild(td_right);tbl_body.appendChild(row);var row=ALib.m_document.createElement("tr");row.className="ContentTableFooterRow";var td_left=ALib.m_document.createElement("td");td_left.className="ContentTableFooterLeftCorn";row.appendChild(td_left);var td_middle=ALib.m_document.createElement("td");td_middle.className="ContentTableFooterCenter";row.appendChild(td_middle);var td_right=ALib.m_document.createElement("td");td_right.className="ContentTableFooterRightCorn";row.appendChild(td_right);tbl_body.appendChild(row);table.appendChild(tbl_body);this.m_table=table;this.m_contentdiv=divContent}CContentTable.prototype.print=function(div_parent){try{if(div_parent){this.m_parentdiv=div_parent;div_parent.appendChild(this.m_table)}else document.write(this.m_table.outerHTML)}catch(e){}}CContentTable.prototype.write=function(htm){this.m_contentdiv.innerHTML+=htm}CContentTable.prototype.get_cdiv=function(){return this.m_contentdiv}CContentTable.prototype.getCon=function(){return this.m_contentdiv}CContentTable.prototype.getTitleCon=function(){return this.m_spTitle}CContentTable.prototype.setTitle=function(title){this.m_spTitle.innerHTML=title}CContentTable.prototype.getOuterCon=function(){return this.m_table}CContentTable.prototype.get_ctitle=function(){return this.m_context}CContentTable.prototype.getContextCon=function(){return this.m_context}CContentTable.prototype.hide=function(){this.m_table.style.display="none"}CContentTable.prototype.show=function(){this.m_table.style.display="block";if(this.m_width)ALib.Dom.styleSet(this.m_table,"width",this.m_width)}CContentTable.prototype.unload=function(){if(this.m_parentdiv){this.m_parentdiv.removeChild(this.m_table)}}var g_cdt_tind=0;var g_cdt_tables=new Array();function CDatasheet(width,height,show_headers,show_rowtitle){this.show_rowtitles=(show_rowtitle)?show_rowtitle:true;this.clicksToEdit="double";var table=ALib.m_document.createElement("table");table.className="CDatasheetMainTable";table.setAttribute("cellpadding","0");table.cellPadding="0";table.setAttribute("cellspacing","0");table.cellSpacing="0";table.setAttribute("border","0");table.border="0";if(width)table.style.width=width;if(height)table.style.height=height;var tbl_body=ALib.m_document.createElement("TBODY")table.appendChild(tbl_body);this.m_table=table;this.m_table_body=tbl_body;this.m_numrows=0;this.m_rows=new Array();this.m_cols=new Array();this.m_rowBody=null;this.m_headersrow=null;this.onCellChange=new Function();this.onCellUpdate=new Function();this.m_uni_id="alib_cdt_"+g_cdt_tind;g_cdt_tables[g_cdt_tind]=this;g_cdt_tind++}CDatasheet.prototype.addHeader=function(title,align,width,height,idname){if(!align)var align="left";if(!this.m_headersrow){this.m_headersrow=ALib.m_document.createElement("tr");this.m_table_body.appendChild(this.m_headersrow);if(this.show_rowtitles){var td_body=ALib.m_document.createElement("td");ALib.Dom.styleSetClass(td_body,"CDatasheetRowTitle");this.m_headersrow.appendChild(td_body)}}var td=ALib.m_document.createElement("td");td.innerHTML=title;ALib.Dom.styleSetClass(td,"CDatasheetHeaderCell");td.align=align;td.setAttribute("align",align);if(width)td.style.width=width;if(height)td.style.height=height;this.m_headersrow.appendChild(td);this.m_cols[this.m_cols.length]=td;return td}CDatasheet.prototype.addRow=function(idname,title){var name=(idname)?idname:this.m_numrows;this.m_lastRow=name;this.m_rows[name]=new CDatasheetRow();this.m_rows[name].m_hinst=this;this.m_rows[name].m_name=name;this.m_rows[name].m_uni_id=this.m_uni_id+"_row_"+name;this.m_rowBody=ALib.m_document.createElement("tr");ALib.Dom.styleSetClass(this.m_rowBody,"CDatasheetRow");this.m_rowBody.valign="top";this.m_rowBody.setAttribute("valign","top");this.m_table_body.appendChild(this.m_rowBody);this.m_rows[name].m_row=this.m_rowBody;this.m_numrows++;if(this.show_rowtitles){var td_body=ALib.m_document.createElement("td");ALib.Dom.styleSetClass(td_body,"CDatasheetRowTitle");if(typeof title!="undefined"){if(typeof title=="string"||typeof title=="number")td_body.innerHTML=title;else{try{td_body.appendChild(title)}catch(e){}}}this.m_rows[name].m_titlecell=td_body;this.m_rows[name].m_row.appendChild(td_body)}return this.m_rows[name]}CDatasheet.prototype.numRows=function(){return this.m_numrows}CDatasheet.prototype.rows=function(name){return this.m_rows[name]}CDatasheet.prototype.removeRow=function(indx){this.m_table_body.removeChild(this.m_rows[indx].m_row);this.m_numrows=this.m_numrows-1}CDatasheet.prototype.addCell=function(content,align,width,height,readonly,colind,row){var name=(row)?row.m_name:this.m_lastRow;var f_readonly=(readonly)?readonly:false;var td_body=ALib.m_document.createElement("td");td_body.m_row=row;td_body.m_colind=colind;td_body.f_readonly=f_readonly;td_body.m_tblcls=this;ALib.Dom.styleSetClass(td_body,"CDatasheetCell");td_body.align=(align)?align:"left";if(width)td_body.style.width=width;if(height)td_body.style.width=height;if(typeof content=="string")td_body.innerHTML=content;else{try{td_body.appendChild(content)}catch(e){}}if(this.clicksToEdit=="double"){var clkfctn=function(){if(this.m_tblcls.m_lastCellSelected)ALib.Dom.styleSetClass(this.m_tblcls.m_lastCellSelected,"CDatasheetCell");ALib.Dom.styleSetClass(this,"CDatasheetCellSelected");this.m_tblcls.m_lastCellSelected=this}td_body.onclick=clkfctn;if(!f_readonly){var dblclkfctn=function(){var buf=this.innerHTML;ALib.Dom.styleSetClass(this,"CDatasheetCellEdit");this.onclick=function(){};this.innerHTML="";var inp=ALib.m_document.createElement("input");ALib.Dom.styleSet(inp,"width","99%");ALib.Dom.styleSet(inp,"height","100%");inp.value=buf;inp.m_td=this;inp.onkeydown=function(e){this.m_td.m_tblcls.onCellUpdate(this.m_td.m_row.m_name,this.m_td.m_colind)}inp.onblur=function(){inp.m_td.innerHTML=this.value;ALib.Dom.styleSetClass(inp.m_td,"CDatasheetCell");inp.m_td.m_tblcls.onCellChange(this.m_td.m_row.m_name,this.m_td.m_colind);inp.m_td.onclick=clkfctn;inp.m_td.ondblclick=dblclkfctn}this.appendChild(inp);this.ondblclick=function(){};inp.select();inp.focus()};td_body.ondblclick=dblclkfctn}}else{if(!f_readonly){var clkfctn=function(){this.m_origbuf=this.innerHTML;ALib.Dom.styleSetClass(this,"CDatasheetCellEdit");this.onclick=function(){};this.innerHTML="";var inp=ALib.m_document.createElement("input");ALib.Dom.styleSet(inp,"width","100%");ALib.Dom.styleSet(inp,"height","100%");inp.value=this.m_origbuf;inp.m_td=this;inp.onkeyup=function(e){this.m_td.m_tblcls.onCellUpdate(this.m_td.m_row.m_name,this.m_td.m_colind)}inp.onblur=function(){inp.m_td.innerHTML=this.value;ALib.Dom.styleSetClass(inp.m_td,"CDatasheetCell");inp.m_td.onclick=clkfctn;if(this.value!=inp.m_td.m_origbuf)inp.m_td.m_tblcls.onCellChange(this.m_td.m_row.m_name,this.m_td.m_colind)}this.appendChild(inp);this.onclick=function(){};inp.select();inp.focus()};td_body.onclick=clkfctn}}this.m_rows[name].m_row.appendChild(td_body);return td_body}CDatasheet.prototype.print=function(div_parent){if(div_parent)div_parent.appendChild(this.m_table);else document.write(this.m_table.outerHTML);this.fixColSize()}CDatasheet.prototype.getValue=function(row,col){if(this.m_rows[row].m_cols[col])return this.m_rows[row].m_cols[col].m_td.innerHTML}CDatasheet.prototype.fixColSize=function(){for(var i=0;i<this.m_cols.length;i++){var width=ALib.Dom.styleGet(this.m_cols[i],"width");ALib.Dom.styleSet(this.m_cols[i],"width",width)}}function CDatasheetRow(){this.m_row;this.m_hinst;this.m_name;this.m_titlecell=null;this.m_uni_id=null;this.m_colind=0;this.m_cols=new Array()}CDatasheetRow.prototype.setName=function(name){this.m_hinst.m_rows[name]=this.m_hinst.m_rows[this.m_name];this.m_hinst.m_rows[this.m_name]=null;this.m_name=name}CDatasheetRow.prototype.setTitle=function(title){if(this.m_titlecell){if(typeof title=="string"||typeof title=="number")this.m_titlecell.innerHTML=title;else{try{this.m_titlecell.appendChild(title)}catch(e){}}}}CDatasheetRow.prototype.addCell=function(content,align,width,height,readonly){if(!content)var content=null;if(!align)var align=null;if(!width)var width=null;if(!height)var height=null;if(!readonly)var readonly=null;this.m_cols[this.m_colind]=new CDatasheetCell(content,this);this.m_cols[this.m_colind].m_td=this.m_hinst.addCell(content,align,width,height,readonly,this.m_colind,this);this.m_colind++}CDatasheetRow.prototype.deleteRow=function(){this.m_hinst.removeRow(this.m_name)}CDatasheetRow.prototype.getId=function(){return this.m_uni_id}CDatasheetRow.prototype.cols=function(colname){return this.m_cols[colname]}function CDatasheetCell(title,row){this.m_name=row;this.m_title=null;this.m_td=null}CDatasheetCell.prototype.setTitle=function(title){if(typeof title=="string"||typeof title=="number")this.m_td.innerHTML=title;else{try{this.m_td.innerHTML="";this.m_td.appendChild(title)}catch(e){}}}function CDom(){this.m_binfo=null;this.m_stylecache={};this.m_document=document}CDom.prototype.setCurrentDoc=function(doc){this.m_document=doc;var cls=this;if(this.m_binfo.ie){this.m_document.detachEvent('onmousemove',cls.setMouseCoords);this.m_document.attachEvent('onmousemove',cls.setMouseCoords)}else{try{this.m_document.removeEventListener('mousemove',cls.setMouseCoords,false);this.m_document.addEventListener('mousemove',cls.setMouseCoords,false)}catch(e){}}}CDom.prototype.createElement=function(type,appendto){var dv=this.m_document.createElement(type);if(appendto)appendto.appendChild(dv);return dv}CDom.prototype.getElementById=function(id){var ele=this.m_document.getElementById(id);return ele}CDom.prototype.styleToCamel=function(property){var change=function(prop){var test=/(-[a-z])/i.exec(prop);var ret=prop.replace(RegExp.$1,RegExp.$1.substr(1).toUpperCase());return ret};while(property.indexOf('-')>-1)property=change(property);return property}CDom.prototype.styleToHyphen=function(property){if(property.indexOf('-')>-1)return property;var converted='';for(var i=0,len=property.length;i<len;++i){if(property.charAt(i)==property.charAt(i).toUpperCase()){converted=converted+'-'+property.charAt(i).toLowerCase()}else{converted=converted+property.charAt(i)}}return converted}CDom.prototype.styleMakeCache=function(property){this.m_stylecache[property]={camel:this.styleToCamel(property),hyphen:this.styleToHyphen(property)}};CDom.prototype.styleGet=function(element,property){var val=null;var dv=this.m_document.defaultView;if(!element)return null;if(!this.m_stylecache[property])this.styleMakeCache(property);var camel=this.m_stylecache[property]['camel'];var hyphen=this.m_stylecache[property]['hyphen'];if(property=='opacity'&&element.filters){val=1;try{val=element.filters.item('DXImageTransform.Microsoft.Alpha').opacity/100}catch(e){try{val=element.filters.item('alpha').opacity/100}catch(e){}}}else if(element.style[camel]){val=element.style[camel]}else if(this.m_binfo.ie&&element.currentStyle&&element.currentStyle[camel]){val=element.currentStyle[camel]}else if(dv&&dv.getComputedStyle){var computed=dv.getComputedStyle(element,'');if(computed&&computed.getPropertyValue(hyphen)){val=computed.getPropertyValue(hyphen)}}return val}CDom.prototype.styleSet=function(element,property,value){if(!this.m_stylecache[property])this.styleMakeCache(property);var camel=this.m_stylecache[property]['camel'];switch(property){case'opacity':if(this.m_binfo.ie&&typeof element.style.filter=='string'){element.style.filter='alpha(opacity='+value*100+')';if(!element.currentStyle||!element.currentStyle.hasLayout){element.style.zoom=1}}else{element.style.opacity=value;element.style['-moz-opacity']=value;element.style['-khtml-opacity']=value}break;case'float':if(this.m_binfo.ie)element.style['styleFloat']=value;else element.style['cssFloat']=value;break;default:element.style[camel]=value}}CDom.prototype.getClientHeight=function(){var height=-1;var mode=this.m_document.compatMode;if((mode||this.m_binfo.ie)&&!this.m_binfo.opera){switch(mode){case'CSS1Compat':height=this.m_document.documentElement.clientHeight;break;default:height=this.m_document.body.clientHeight}}else{height=self.innerHeight}return height}CDom.prototype.GetClientHeight=function(){return this.getClientHeight()}CDom.prototype.getClientWidth=function(){var width=-1;var mode=this.m_document.compatMode;if(mode||this.m_binfo.ie){switch(mode){case'CSS1Compat':width=this.m_document.documentElement.clientWidth;break;default:width=this.m_document.body.clientWidth}}else{width=self.innerWidth}return width}CDom.prototype.GetClientWidth=function(){this.getClientWidth()}CDom.prototype.getDocumentHeight=function(){var scrollHeight=-1;ALib.m_evwnd.eight=-1;var bodyHeight=-1;var marginTop=parseInt(this.styleGet(this.m_document.body,'marginTop'),10);var marginBottom=parseInt(this.styleGet(this.m_document.body,'marginBottom'),10);var mode=this.m_document.compatMode;if((mode||this.m_binfo.ie)&&!this.m_binfo.opera){switch(mode){case'CSS1Compat':scrollHeight=((ALib.m_evwnd.innerHeight&&ALib.m_evwnd.scrollMaxY)?ALib.m_evwnd.innerHeight+ALib.m_evwnd.scrollMaxY:-1);ALib.m_evwnd.eight=[this.m_document.documentElement.clientHeight,self.innerHeight||-1].sort(function(a,b){return(a-b)})[1];bodyHeight=this.m_document.body.offsetHeight+marginTop+marginBottom;break;default:scrollHeight=this.m_document.body.scrollHeight;bodyHeight=this.m_document.body.clientHeight}}else{scrollHeight=this.m_document.documentElement.scrollHeight;ALib.m_evwnd.eight=self.innerHeight;bodyHeight=this.m_document.documentElement.clientHeight}var h=[scrollHeight,ALib.m_evwnd.eight,bodyHeight].sort(function(a,b){return(a-b)});return h[2]}CDom.prototype.GetDocumentHeight=function(){return this.getDocumentHeight()}CDom.prototype.getDocumentWidth=function(){var docWidth=-1,bodyWidth=-1,winWidth=-1;var marginRight=parseInt(this.styleGet(this.m_document.body,'marginRight'),10);var marginLeft=parseInt(this.styleGet(this.m_document.body,'marginLeft'),10);var mode=this.m_document.compatMode;if(mode||isIE){switch(mode){case'CSS1Compat':docWidth=this.m_document.documentElement.clientWidth;bodyWidth=this.m_document.body.offsetWidth+marginLeft+marginRight;winWidth=self.innerWidth||-1;break;default:bodyWidth=this.m_document.body.clientWidth;winWidth=this.m_document.body.scrollWidth;break}}else{docWidth=this.m_document.documentElement.clientWidth;bodyWidth=this.m_document.body.offsetWidth+marginLeft+marginRight;winWidth=self.innerWidth}var w=[docWidth,bodyWidth,winWidth].sort(function(a,b){return(a-b)});return w[2]}CDom.prototype.GetDocumentWidth=function(){return this.getDocumentWidth()}CDom.prototype.getScrollPosLeft=function(){return typeof ALib.m_evwnd.pageXOffset!='undefined'?ALib.m_evwnd.pageXOffset:ALib.m_document.documentElement&&ALib.m_document.documentElement.scrollLeft?ALib.m_document.documentElement.scrollLeft:ALib.m_document.body.scrollLeft?ALib.m_document.body.scrollLeft:0}CDom.prototype.getScrollPosTop=function(){return typeof ALib.m_evwnd.pageYOffset!='undefined'?ALib.m_evwnd.pageYOffset:ALib.m_document.documentElement&&ALib.m_document.documentElement.scrollTop?ALib.m_document.documentElement.scrollTop:ALib.m_document.body.scrollTop?ALib.m_document.body.scrollTop:0}CDom.prototype.styleAddClass=function(element,className){element['className']=[element['className'],className].join(' ')}CDom.prototype.StyleAddClass=function(element,className){this.styleAddClass(element,className)}CDom.prototype.styleSetClass=function(element,className){element['className']=className}CDom.prototype.setClass=function(element,className){this.styleSetClass(element,className)}CDom.prototype.getElementPosition=function(o){var left=0;var top=0;var right=o.offsetWidth;var bottom=o.offsetHeight;while(o.offsetParent){left+=o.offsetLeft;top+=o.offsetTop;o=o.offsetParent}left+=o.offsetLeft;top+=o.offsetTop;right+=left;bottom+=top;return{x:left,y:top,r:right,b:bottom}}CDom.prototype.setMouseCoords=function(ev){ev=CDomFixEvent(ev);if(ev.pageX||ev.pageY){ALib.Dom.mouse_x=ev.pageX;ALib.Dom.mouse_y=ev.pageY}else{try{ALib.Dom.mouse_x=ev.clientX+ALib.m_document.body.scrollLeft-ALib.m_document.body.clientLeft;ALib.Dom.mouse_y=ev.clientY+ALib.m_document.body.scrollTop-ALib.m_document.body.clientTop}catch(e){}}}CDom.prototype.getMouseCoords=function(){return{x:ALib.Dom.mouse_x,y:ALib.Dom.mouse_y}}CDom.prototype.changeFontSize=function(e,type,min,max){if(typeof e=="string")e=this.getElementById(e);if(!min)var min=8;if(!max)var max=18;if(e.style.fontSize){var s=parseInt(e.style.fontSize.replace("px",""))}else{var s=12}if(type=="-"){if(s!=min){s-=1}}else{if(s!=max){s+=1}}e.style.fontSize=s+"px"}CDom.prototype.setInputBlurText=function(e,text,blurclass,onclass,overclass){if(typeof e=="string")e=this.getElementById(e);e.Dom=this;e.blurtext=text;if(onclass)e.onclass=onclass;if(blurclass)e.blurclass=blurclass;if(overclass)e.overclass=overclass;e.onfocus=function(){if(this.overclass){this.onmouseover=function(){this.Dom.styleSetClass(this,this.overclass)}this.onmouseout=function(){if(this.onclass)this.Dom.styleSetClass(this,this.onclass);else this.Dom.styleSetClass(this,"")}}this.value="";if(this.onclass)this.Dom.styleSetClass(this,this.onclass);else if(this.blurclass)this.Dom.styleSetClass(this,"")};e.onblur=function(){if(this.overclass){this.onmouseover=function(){this.Dom.styleSetClass(this,this.overclass)}this.onmouseout=function(){if(this.blurclass)this.Dom.styleSetClass(this,this.blurclass);else this.Dom.styleSetClass(this,"")}}if(this.blurclass)this.Dom.styleSetClass(this,this.blurclass);if(this.value==""){this.value=this.blurtext}}e.value=text;if(blurclass)this.styleSetClass(e,blurclass);if(overclass){e.onmouseover=function(){this.Dom.styleSetClass(this,this.overclass)}e.onmouseout=function(){if(this.blurclass)this.Dom.styleSetClass(this,this.blurclass);else this.Dom.styleSetClass(this,"")}}}CDom.prototype.textAreaAutoResizeHeight=function(e,min_height,max_heigh){var minHeight=(typeof min_height!="undefined")?min_height:null;var maxHeight=(typeof max_height!="undefined")?max_height:null;if(typeof e=="string")e=this.getElementById(e);e.minHeight=minHeight;e.maxHeight=maxHeight;e.autoResizeHeight=function(){if(!ALib.m_browser.ie)this.style.height=0;if(this.minHeight){if(this.scrollHeight<this.minHeight){if(!ALib.m_browser.ie)this.style.height=this.minHeight+"px";return true}}if(this.maxHeight){if(this.scrollHeight>this.maxHeight)return true}this.style.height=this.scrollHeight+5+"px"}var funct=function(e){if(ALib.m_browser.ie)var ta=ALib.m_evwnd.event.srcElement;else var ta=this;ta.autoResizeHeight()}if(this.m_binfo.ie){e.attachEvent('onkeyup',funct)}else{try{e.addEventListener('keyup',funct,false)}catch(e){}}}function CDomFixEvent(e){if(typeof e=='undefined'){if(ALib.m_evwnd)e=ALib.m_evwnd.event;else e=ALib.m_evwnd.event}if(e){if(typeof e.layerX=='undefined')e.layerX=e.offsetX;if(typeof e.layerY=='undefined')e.layerY=e.offsetY;return e}else return null}var DragAndDrop={obj:null,dropzones:new Array,registerDragable:function(o,oRoot,dzgroup,minX,maxX,minY,maxY){o.onmousedown=DragAndDrop.start;o.hmode=true;o.vmode=true;o.root=(oRoot&&oRoot!=null)?oRoot:o;if(dzgroup)o.m_groupName=dzgroup;o.m_dragCon=ALib.m_document.createElement("div");ALib.m_document.body.appendChild(o.m_dragCon);o.m_dragCon.style.position="absolute";o.m_dragCon.style.top="0px";o.m_dragCon.style.left="0px";o.m_dragCon.style.display="none";o.minX=typeof minX!='undefined'?minX:null;o.minY=typeof minY!='undefined'?minY:null;o.maxX=typeof maxX!='undefined'?maxX:null;o.maxY=typeof maxY!='undefined'?maxY:null;o.root.onDragStart=new Function();o.root.onDragEnd=new Function();o.root.onDrag=new Function()},start:function(e){var o=DragAndDrop.obj=this;e=DragAndDrop.fixE(e);var pos=ALib.Dom.getElementPosition(DragAndDrop.obj.root);var y=pos.y;var x=pos.x;o.root.onDragStart(x,y);if(typeof o.m_dragConSet=="undefined"){var icon=ALib.m_document.createElement("div");ALib.Dom.styleSet(icon,"border",o.style.border);ALib.Dom.styleSet(icon,"width",(pos.r-pos.x)+"px");ALib.Dom.styleSet(icon,"height",(pos.b-pos.y)+"px");icon.innerHTML=o.root.innerHTML;DragAndDrop.setDragGuiCon(o,icon)}o.m_dragCon.style.display="block";o.m_dragCon.style.top=y+"px";o.m_dragCon.style.left=x+"px";o.lastMouseX=e.clientX;o.lastMouseY=e.clientY;if(o.minX!=null)o.minMouseX=e.clientX-x+o.minX;if(o.maxX!=null)o.maxMouseX=o.minMouseX+o.maxX-o.minX;if(o.minY!=null)o.minMouseY=e.clientY-y+o.minY;if(o.maxY!=null)o.maxMouseY=o.minMouseY+o.maxY-o.minY;ALib.m_document.onmousemove=DragAndDrop.drag;ALib.m_document.onmouseup=DragAndDrop.end;return false},drag:function(e){e=DragAndDrop.fixE(e);var o=DragAndDrop.obj;var ey=e.clientY;var ex=e.clientX;var y=parseInt(o.m_dragCon.style.top);var x=parseInt(o.m_dragCon.style.left);var nx,ny;if(o.minX!=null)ex=Math.max(ex,o.minMouseX);if(o.maxX!=null)ex=Math.min(ex,o.maxMouseX);if(o.minY!=null)ey=Math.max(ey,o.minMouseY);if(o.maxY!=null)ey=Math.min(ey,o.maxMouseY);nx=x+(ex-o.lastMouseX);ny=y+(ey-o.lastMouseY);var dz=DragAndDrop.inDropZone(o,ex,ey);if(o.m_dz){if(dz){if(dz!=o.m_dz){DragAndDrop.dzDragExit(o.m_dz,o);o.m_dz=dz;DragAndDrop.dzDragEnter(dz,o)}}else{DragAndDrop.dzDragExit(o.m_dz,o);o.m_dz=null}}else{if(dz){o.m_dz=dz;DragAndDrop.dzDragEnter(dz,o)}}if(DragAndDrop.obj.m_dragOffsetX)DragAndDrop.obj.m_dragCon.style["left"]=(ex+DragAndDrop.obj.m_dragOffsetX)+"px";else DragAndDrop.obj.m_dragCon.style["left"]=nx+"px";if(DragAndDrop.obj.m_dragOffsetY)DragAndDrop.obj.m_dragCon.style["top"]=(ey+DragAndDrop.obj.m_dragOffsetY)+"px";else DragAndDrop.obj.m_dragCon.style["top"]=ny+"px";DragAndDrop.obj.lastMouseX=ex;DragAndDrop.obj.lastMouseY=ey;if(DragAndDrop.obj.m_dragOffsetX)nx=ex;if(DragAndDrop.obj.m_dragOffsetY)ny=ey;DragAndDrop.obj.root.onDrag(nx,ny);return false},end:function(){ALib.m_document.onmousemove=null;ALib.m_document.onmouseup=null;var x=DragAndDrop.obj.lastMouseX;var y=DragAndDrop.obj.lastMouseY;var pos=ALib.Dom.getElementPosition(DragAndDrop.obj.m_dragCon);var reportX=pos.x;var reportY=pos.y;if(DragAndDrop.obj.m_dragOffsetX)reportX=x;if(DragAndDrop.obj.m_dragOffsetY)reportY=y;if(!DragAndDrop.dropzones.length||(DragAndDrop.dropzones.length&&DragAndDrop.obj.m_dz)||!DragAndDrop.obj.m_groupName){DragAndDrop.obj.root.onDragEnd(reportX,reportY)}DragAndDrop.obj.m_dragCon.style.display="none";if(DragAndDrop.obj.m_dz){DragAndDrop.dzDragDrop(DragAndDrop.obj.m_dz,DragAndDrop.obj)}DragAndDrop.obj=null},fixE:function(e){if(typeof e=='undefined'){if(ALib.m_evwnd)e=ALib.m_evwnd.event;else e=window.event}if(typeof e.layerX=='undefined')e.layerX=e.offsetX;if(typeof e.layerY=='undefined')e.layerY=e.offsetY;return e},setDragGuiCon:function(obj,con,offsetX,offsetY){DragAndDrop.clearDragGuiCon(obj.m_dragCon);obj.m_dragCon.appendChild(con);obj.m_dragConSet=true;obj.m_dragOffsetX=null;obj.m_dragOffsetY=null;if(offsetX)obj.m_dragOffsetX=offsetX;if(offsetY)obj.m_dragOffsetY=offsetY},clearDragGuiCon:function(con){con.innerHTML=""},inDropZone:function(e,x,y){var objPos=[];for(var i=0;i<this.dropzones.length;i++){objPos=ALib.Dom.getElementPosition(this.dropzones[i],true);if(x>=objPos.x&&y>=objPos.y&&y<=objPos.b&&x<=objPos.r){if(e.m_groupName){if(e.m_groupName==this.dropzones[i].m_groupName)return this.dropzones[i]}}}return null},getElementPosition:function(o){var left=0;var top=0;var right=o.offsetWidth;var bottom=o.offsetHeight;while(o.offsetParent){left+=o.offsetLeft;top+=o.offsetTop;o=o.offsetParent}left+=o.offsetLeft;top+=o.offsetTop;right+=left;bottom+=top;return{x:left,y:top,r:right,b:bottom}},mouseCoords:function(ev){if(ev.pageX||ev.pageY)return{x:ev.pageX,y:ev.pageY};return{x:ev.clientX+ALib.m_document.body.scrollLeft-ALib.m_document.body.clientLeft,y:ev.clientY+ALib.m_document.body.scrollTop-ALib.m_document.body.clientTop}},registerDropzone:function(o,groupname){var ind=this.dropzones.length;this.dropzones[ind]=o;o.m_groupName=groupname;o.onDragEnter=new Function;o.onDragExit=new Function;o.onDragDrop=new Function},dzDragEnter:function(dz,e){dz.onDragEnter(e)},dzDragExit:function(dz,e){dz.onDragExit(e)},dzDragDrop:function(dz,e){dz.onDragDrop(e)}};var g_mRootDiv=null;var g_mClearTimer=null;var g_mClearObj=new Object();var mDivMClicked=null;var mDivRootMenu=null;var GTIMERCLEAR=null;var mRootBtn=null;var mChildActive=null;var g_CDMenues=new Array();var g_CDMenCount=0;function CDropAddHandler(doc){doc.onclick=function(){if(g_mRootDiv){if((g_mRootDiv.m_HaveMouseFocus==false||!g_mRootDiv.m_HaveMouseFocus)){g_mRootDiv.unloadMe();g_mRootDiv=null}}}}function CDropdownMenuDocClick(){try{if(g_mRootDiv){if((g_mRootDiv.m_HaveMouseFocus==false||!g_mRootDiv.m_HaveMouseFocus)){if(g_mRootDiv.m_button.onclickold)g_mRootDiv.m_button.onclick=g_mRootDiv.m_button.onclickold;g_mRootDiv.unloadMe();g_mRootDiv=null}}}catch(e){}}function CDropdownMenu(pnt){if(pnt)this.m_parent=pnt;this.m_div=ALib.m_document.createElement("div");this.m_div.style.position="absolute";this.m_div.style.top="0px";this.m_div.style.left="0px";this.m_div.style.zIndex=g_CDMenCount;this.m_div.menuref=this;this.m_div.onmouseover=function(){this.menuref.handleMouseOver()}this.m_div.onmouseout=function(){this.menuref.handleMouseOut()}this.m_div.style.visibility="hidden";this.m_table=ALib.m_document.createElement("table");this.m_table.setAttribute("border","0");this.m_table.border="0";this.m_table.setAttribute("cellpadding","0");this.m_table.cellPadding="0";this.m_table.setAttribute("cellspacing","0");this.m_table.cellSpacing="0";this.m_table.className="CDropdownMenuContainer";this.m_tbody=ALib.m_document.createElement("tbody");this.m_table.appendChild(this.m_tbody);this.m_div.appendChild(this.m_table);this.m_fulldiv=ALib.m_document.createElement("div");this.m_id=g_CDMenCount;if(pnt)this.m_droptype='right';else this.m_droptype='down';if(typeof Ant!='undefined')this.m_themename=Ant.m_theme;else this.m_themename='default';g_CDMenues[g_CDMenCount]=this;g_CDMenCount++}CDropdownMenu.prototype.destroyMenu=function(title){if(this.m_parent){g_mRootDiv.destroyMenu()}else{this.unloadMe();delete g_CDMenues[this.m_id]}}CDropdownMenu.prototype.createLinkMenu=function(title){var div=ALib.m_document.createElement("span");div.menuref=this;div.onclick=function(){this.menuref.toggleMenu()}div.onmouseover=function(){this.menuref.handleMouseOver()}div.onmouseout=function(){this.menuref.handleMouseOut()}div.style.cursor="pointer";div.innerHTML=title;this.m_button=div;this.m_fulldiv.appendChild(div);this.m_fulldiv.appendChild(this.m_div);return this.m_fulldiv}CDropdownMenu.prototype.createContextMenu=function(e,cls_out,cls_over,cls_on){if(typeof e=="string")e=ALib.getElementById(e);if(cls_out)this.m_clsOut=cls_out;if(cls_over)this.m_clsOver=cls_over;if(cls_on)this.m_clsOn=cls_on;e.menuref=this;e.m_cls=this;e.oncontextmenu=function(){this.onclickold=this.onclick;this.onclick=null;var cls=this.m_cls;cls.toggleMenu();this.onclick=function(){this.onclick=this.onclickold};return false};var funover=function(){this.m_cls.handleMouseOver();if(this.menuref.m_clsOver&&this.menuref.m_div.style.visibility=="hidden")ALib.Dom.styleSetClass(this,this.menuref.m_clsOver)}var funout=function(){this.m_cls.handleMouseOut();if(this.menuref.m_clsOut&&this.menuref.m_div.style.visibility=="hidden")ALib.Dom.styleSetClass(this,this.menuref.m_clsOut)}if(ALib.Dom.m_binfo.ie){e.attachEvent('mouseover',funover);e.attachEvent('mouseout',funout)}else{e.addEventListener('mouseover',funover,false);e.addEventListener('mouseout',funout,false)}this.m_button=e;this.m_fulldiv.appendChild(this.m_div);e.appendChild(this.m_fulldiv)}CDropdownMenu.prototype.createImageMenu=function(img_out,img_over,img_on){if(img_out)this.m_imageOut=img_out;else if(Ant)this.m_imageOut="/images/themes/"+Ant.m_theme+"/buttons/dropdownOut.gif";if(img_over)this.m_imageOver=img_over;else if(Ant)this.m_imageOver="/images/themes/"+Ant.m_theme+"/buttons/dropdownOver.gif";if(img_on)this.m_imageOn=img_on;else if(Ant)this.m_imageOn="/images/themes/"+Ant.m_theme+"/buttons/dropdownOn.gif";var div=ALib.m_document.createElement("span");div.menuref=this;div.style.cursor="pointer";div.m_image=ALib.m_document.createElement("img");div.m_image.border="0";div.m_image.src=this.m_imageOut;div.appendChild(div.m_image);div.m_imageOut=this.m_imageOut;div.m_imageOver=this.m_imageOver;div.onclick=function(){this.menuref.toggleMenu()}div.onmouseover=function(){this.menuref.handleMouseOver();if(this.menuref.m_div.style.visibility=="hidden")div.m_image.src=this.m_imageOver}div.onmouseout=function(){this.menuref.handleMouseOut();if(this.menuref.m_div.style.visibility=="hidden")div.m_image.src=this.m_imageOut}this.m_button=div;this.m_fulldiv.appendChild(div);this.m_fulldiv.appendChild(this.m_div);return this.m_fulldiv}CDropdownMenu.prototype.createButtonMenu=function(title){var full_title="<div style='float:left;' class='CDropdownMenuButtonPrefix'></div>";full_title+=(title)?title:'';full_title+="<div style='clear:both'></div>";var btn=new CButton(full_title,"g_CDMenues["+this.m_id+"].toggleMenu()",null,"b1");var button_con=btn.getButton();var button_tbl=btn.getTable();button_tbl.menuref=this;button_tbl.onmouseover=function(){this.menuref.handleMouseOver()}button_tbl.onmouseout=function(){this.menuref.handleMouseOut()}this.m_button=button_con;this.m_fulldiv.appendChild(button_con);this.m_fulldiv.appendChild(this.m_div);return this.m_fulldiv}CDropdownMenu.prototype.createCustomnMenu=function(element,cls_out,cls_over,cls_on){if(cls_out)this.m_clsOut=cls_out;if(cls_over)this.m_clsOver=cls_over;if(cls_on)this.m_clsOn=cls_on;element.menuref=this;element.onclick=function(){this.menuref.toggleMenu()}element.onmouseover=function(){this.menuref.handleMouseOver();if(this.menuref.m_clsOver&&this.menuref.m_div.style.visibility=="hidden")ALib.Dom.styleSetClass(this,this.menuref.m_clsOver)}element.onmouseout=function(){this.menuref.handleMouseOut();if(this.menuref.m_clsOut&&this.menuref.m_div.style.visibility=="hidden")ALib.Dom.styleSetClass(this,this.menuref.m_clsOut)}this.m_button=element;this.m_fulldiv.appendChild(element);this.m_fulldiv.appendChild(this.m_div);return this.m_fulldiv}CDropdownMenu.prototype.addEntry=function(title,funct,icon,icon_text,fargs){var row=ALib.m_document.createElement("tr");row.menuref=this;var cell_icon=ALib.m_document.createElement("td");cell_icon.className="CDropdownMenuIcon";cell_icon.style.whiteSpace="nowrap";if(icon){cell_icon.innerHTML="<img border='0' src='"+icon+"' style='padding: 0px; margin: 0px;' />"}else{cell_icon.innerHTML="<div>"+((icon_text)?icon_text:'')+"</div>"}row.appendChild(cell_icon);var cell_link=ALib.m_document.createElement("td");cell_link.className="CDropdownMenuLink";cell_link.nowrap=true;cell_link.style.whiteSpace="nowrap";cell_link.innerHTML=title;row.appendChild(cell_link);var cell_right=ALib.m_document.createElement("td");cell_right.className="CDropdownMenuRight";cell_right.nowrap=true;cell_right.style.whiteSpace="nowrap";cell_right.innerHTML="&nbsp;";row.appendChild(cell_right);if(funct){row.style.cursor="pointer";row.functname=funct;row.onclick=function(){if(typeof this.functname!="string"){if(typeof fargs!="undefined"&&fargs){switch(fargs.length){case 1:this.functname(fargs[0]);break;case 2:this.functname(fargs[0],fargs[1]);break;case 3:this.functname(fargs[0],fargs[1],fargs[2]);break;case 4:this.functname(fargs[0],fargs[1],fargs[2],fargs[3]);break;case 5:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4]);break;case 6:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5]);break;case 7:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5],fargs[6]);break}}else this.functname()}else eval(this.functname);g_mRootDiv.unloadMe();g_mRootDiv=null}}row.onmouseover=function(){if(this.menuref.m_activechild){this.menuref.m_activechild.unloadMe();this.menuref.m_activechild=null}CDMenuSetRowHighligh(true,this)}row.onmouseout=function(){CDMenuSetRowHighligh(false,this)}this.m_tbody.appendChild(row)}CDropdownMenu.prototype.addSubmenu=function(title,icon,funct,fargs){var dlmenu=new CDropdownMenu(this);var row=ALib.m_document.createElement("tr");row.style.cursor="pointer";var cell_icon=ALib.m_document.createElement("td");cell_icon.className="CDropdownMenuIcon";cell_icon.style.width='15px';cell_icon.style.whiteSpace="nowrap";if(icon)cell_icon.innerHTML="<div style='width:15px;'><img border='0' src='"+icon+"' /></div>";else cell_icon.innerHTML="<div style='width:15px;'></div>";row.appendChild(cell_icon);var cell_link=ALib.m_document.createElement("td");cell_link.className="CDropdownMenuLink";cell_link.innerHTML=title;cell_link.nowrap=true;cell_link.style.whiteSpace="nowrap";row.appendChild(cell_link);var cell_right=ALib.m_document.createElement("td");cell_right.className="CDropdownMenuRight";cell_right.nowrap=true;cell_right.style.whiteSpace="nowrap";cell_right.innerHTML="<div class='CDropdownMenuRightIcon' align='center'></div>";row.appendChild(cell_right);if(funct){row.style.cursor="pointer";row.functname=funct;row.onclick=function(){if(typeof this.functname!="string"){if(typeof fargs!="undefined"&&fargs){switch(fargs.length){case 1:this.functname(fargs[0]);break;case 2:this.functname(fargs[0],fargs[1]);break;case 3:this.functname(fargs[0],fargs[1],fargs[2]);break;case 4:this.functname(fargs[0],fargs[1],fargs[2],fargs[3]);break;case 5:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4]);break;case 6:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5]);break;case 7:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5],fargs[6]);break}}else this.functname()}else eval(this.functname);g_mRootDiv.unloadMe();g_mRootDiv=null}}row.menuref=dlmenu;dlmenu.m_button=row;row.onmouseover=function(){this.menuref.handleMouseOver();if(this.menuref.m_div.style.visibility=="hidden")this.menuref.toggleMenu();window.clearTimeout(g_mClearObj.timer);g_mClearObj.m_id=null;CDMenuSetRowHighligh(true,this)}row.onmouseout=function(){this.menuref.handleMouseOut();g_mClearObj.m_id=this.menuref.m_id;g_mClearObj.timer=setTimeout('CDMenuClearMenu()',2000);CDMenuSetRowHighligh(false,this)}this.m_tbody.appendChild(row);dlmenu.m_fulldiv.appendChild(dlmenu.m_div);this.m_fulldiv.appendChild(dlmenu.m_fulldiv);return dlmenu}CDropdownMenu.prototype.unloadMe=function(){if(this.m_activechild){this.m_activechild.unloadMe()}this.m_activechild=null;if(this.m_parent)CDMenuSetRowHighligh(false,this.m_button);else{if(this.m_imageOut){if(this.m_button&&this.m_button.m_image)this.m_button.m_image.src=this.m_imageOut}if(this.m_clsOut){if(this.m_button)ALib.Dom.styleSetClass(this.m_button,this.m_clsOut)}}this.m_div.style.visibility="hidden"}CDropdownMenu.prototype.handleMouseOver=function(){this.setFocus(true);if(g_mClearObj.m_id==this.m_id){window.clearTimeout(g_mClearObj.timer);g_mClearObj.m_id=null}if(g_mRootDiv){if((g_mRootDiv.m_HaveMouseFocus==false)){g_mRootDiv.unloadMe();g_mRootDiv=null}}}CDropdownMenu.prototype.handleMouseOut=function(){this.m_HaveMouseFocus=false if(this.m_parent)this.m_parent.m_HaveMouseFocus=false}CDropdownMenu.prototype.setFocus=function(focused){if(focused==true)this.m_HaveMouseFocus=true;if(this.m_parent){CDMenuSetRowHighligh(true,this.m_button);this.m_parent.setFocus(true)}}CDropdownMenu.prototype.toggleMenu=function(){if(this.m_parent){tmpx=this.m_parent.m_div.offsetLeft;tmpy=this.m_parent.m_div.offsetTop+this.m_button.offsetTop;tmpParent=this.m_parent.m_div.offsetParent}else{tmpx=this.m_button.offsetLeft;tmpy=this.m_button.offsetTop;tmpParent=this.m_button.offsetParent}tmpheight=this.m_button.offsetHeight;while(tmpParent!=null){tmpy+=tmpParent.offsetTop;tmpx+=tmpParent.offsetLeft;tmpParent=tmpParent.offsetParent}if(ALib.m_document){var doc_width=ALib.m_document.body.clientWidth}else{var doc_width=document.body.clientWidth}if(this.m_div.style.visibility=="visible"){this.m_div.onfaded=function(){this.style.visibility='hidden'}ALib.Effect.fade(this.m_div,200);if(this.m_parent){if(this.m_parent.m_activechild!=this){this.m_parent.m_activechild.unloadMe()this.m_parent.m_activechild=null}}else{this.unloadMe();g_mRootDiv=null;if(ALib.Dom.m_binfo.ie){ALib.m_document.detachEvent('click',CDropdownMenuDocClick)}else{ALib.m_document.removeEventListener('click',CDropdownMenuDocClick,false)}}}else{if('right'==this.m_droptype){if((tmpx+this.m_button.offsetWidth+this.m_div.offsetWidth)>=doc_width)this.m_droptype='left'}switch(this.m_droptype){case'up':this.m_div.style.top=tmpy-this.m_div.offsetHeight+'px';if((tmpy-this.m_div.offsetHeight)<10){this.m_div.style.top=tmpy+tmpheight+'px'}this.m_div.style.left=tmpx+'px';break;case'down':this.m_div.style.top=tmpy+tmpheight+'px';if((tmpx+this.m_div.offsetWidth)>=doc_width)this.m_div.style.left=doc_width-this.m_div.offsetWidth-1+'px';else this.m_div.style.left=tmpx+'px';break;case'right':this.m_div.style.top=tmpy+'px';this.m_div.style.left=tmpx+this.m_button.offsetWidth-1+'px';break;case'left':this.m_div.style.top=tmpy+'px';this.m_div.style.left=tmpx-this.m_div.offsetWidth+1+'px';break}if(g_mRootDiv&&!this.m_parent){g_mRootDiv.unloadMe()}ALib.Effect.fadein(this.m_div,200);this.m_div.style.visibility="visible";if(this.m_parent){if(this.m_parent.m_activechild&&this.m_parent.m_activechild!=this)this.m_parent.m_activechild.unloadMe();this.m_parent.m_activechild=this}else{g_mRootDiv=this;if(this.m_imageOn)this.m_button.m_image.src=this.m_imageOn;if(this.m_clsOn){ALib.Dom.styleSetClass(this.m_button,this.m_clsOn)}}if(ALib.Dom.m_binfo.ie){ALib.m_document.attachEvent('onclick',CDropdownMenuDocClick)}else{ALib.m_document.addEventListener('click',CDropdownMenuDocClick,false)}}}function CDMenuClearMenu(){g_CDMenues[g_mClearObj.m_id].unloadMe()}function CDMenuSetRowHighligh(setRow,row){if(setRow==true){try{row.childNodes.item(0).className="CDropdownMenuIconOver";row.childNodes.item(1).className="CDropdownMenuLinkOver";row.childNodes.item(2).className="CDropdownMenuRightOver";row.childNodes.item(2).childNodes.item(0).className="CDropdownMenuRightIconOver"}catch(e){}}else{try{row.childNodes.item(0).className="CDropdownMenuIcon";row.childNodes.item(1).className="CDropdownMenuLink";row.childNodes.item(2).className="CDropdownMenuRight";row.childNodes.item(2).childNodes.item(0).className="CDropdownMenuRightIcon"}catch(e){}}}function CMenubar(){this.m_document=ALib.m_document;var doc=this.m_document;this.m_outerdv=doc.createElement("div");var tbl=doc.createElement("table");ALib.Dom.styleSetClass(tbl,"CMenubar");ALib.Dom.styleSet(tbl,"width","100%");tbl.setAttribute("cellpadding","0");tbl.cellPadding="0";tbl.setAttribute("cellspacing","0");tbl.cellSpacing="0";var tbl_bdy=doc.createElement("tbody");tbl.appendChild(tbl_bdy);var row=doc.createElement("tr");tbl_bdy.appendChild(row);var td=doc.createElement("td");row.appendChild(td);this.m_con=td;this.m_outerdv.appendChild(tbl)}CMenubar.prototype.AddItem=function(title,align){var dv=this.m_document.createElement("div");if(align=="right"){ALib.Dom.styleSet(dv,"float","right");ALib.Dom.styleSet(dv,"padding-right","2px")}else{ALib.Dom.styleSet(dv,"float","left");ALib.Dom.styleSet(dv,"padding-left","2px")}dv.innerHTML=title;var dm=new CDropdownMenu();this.m_con.appendChild(dm.createCustomnMenu(dv,"CMenuBarLink","CMenuBarLinkOver","CMenuBarLinkOn"));return dm}CMenubar.prototype.print=function(dv){if(dv)dv.appendChild(this.m_outerdv);else document.write(this.m_outerdv.outerHTML)}CMenubar.prototype.getContainer=function(){return this.m_con}function CNavBar(width){this.m_con=ALib.m_document.createElement("div");if(!width)var width="100%";ALib.Dom.styleSet(this.m_con,"width",width);this.m_items=new Array();this.m_itemcounter=0;this.m_sections=new Array();this.m_sectioncounter=0;this.m_lasesection=null;this.m_appclass=null}CNavBar.prototype.addSectionItem=function(label,icon,action,args,idname,sectionid,depth,parent_node){var name=(idname)?idname:this.getNextItemId();var sect_id=(sectionid)?sectionid:this.m_lasesection;this.m_items[name]=new CNavBarItem(this);var item=this.m_items[name];item.m_secname=sect_id;item.m_idname=name;if(typeof(depth)=="undefined")item.m_depth=0;else item.m_depth=depth;var tr=ALib.m_document.createElement("tr");item.m_tr=tr;if(typeof(parent_node)!="undefined")insertAfter(this.m_sections[sect_id].m_tblbdy,tr,parent_node.m_tr);else this.m_sections[sect_id].m_tblbdy.appendChild(tr);var td=ALib.m_document.createElement("td");ALib.Dom.styleSet(td,"width","100%");tr.appendChild(td);var tbl=ALib.m_document.createElement("table");ALib.Dom.styleSet(tbl,"border","0px");ALib.Dom.styleSet(tbl,"width","100%");tbl.cellPadding=0;tbl.cellSpacing=0;td.appendChild(tbl);var tbody=ALib.m_document.createElement("tbody");tbl.appendChild(tbody);var tr=ALib.m_document.createElement("tr");tbody.appendChild(tr);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMLeftBorder");tr.appendChild(td);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CNavBarItem");ALib.Dom.styleSet(td,"cursor","pointer");item.m_itemcon=td;for(var i=0;i<item.m_depth;i++){var dv=ALib.m_document.createElement("div");ALib.Dom.styleSet(dv,"float","left");ALib.Dom.styleSetClass(dv,"CTreeViewSpaceLine");td.appendChild(dv)}var dv=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(dv,"CNavBarItemIcon");item.m_icon=dv;ALib.Dom.styleSet(dv,"float","left");if(icon){if(typeof(icon)=="string")dv.innerHTML="<img border='0' src='"+icon+"' />";else dv.appendChild(icon)}td.appendChild(dv);var dv=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(dv,"CNavBarItemLink");ALib.Dom.styleSet(dv,"float","left");item.m_link=dv;dv.innerHTML=label;td.appendChild(dv);item.m_linktd=dv;td.m_name=name;td.m_nav=this;td.onmouseover=function(){if(this.className!="CNavBarItemOn")this.m_nav.itemChangeState(this.m_name,"over")};td.onmouseout=function(){if(this.className!="CNavBarItemOn")this.m_nav.itemChangeState(this.m_name,"out")};item.m_linktd.m_action=action;item.m_linktd.m_nav=this;item.m_linktd.m_name=name;item.m_linktd.m_idname=(typeof idname!="undefined")?idname:name;if(args)item.m_linktd.m_args=args;item.m_linktd.onclick=function(){if(this.m_idname!=-1)this.m_nav.itemChangeState(this.m_name,"on");if(this.m_action){if(typeof this.m_action=="string")eval(this.m_action);else{try{if(this.m_args&&this.m_args.length){switch(this.m_args.length){case 3:this.m_action(this.m_args[0],this.m_args[1],this.m_args[2]);break;case 2:this.m_action(this.m_args[0],this.m_args[1]);break;case 1:this.m_action(this.m_args[0]);break}}else this.m_action()}catch(e){}}}};var dv=ALib.Dom.createElement("div");dv.style.clear="both";td.appendChild(dv);tr.appendChild(td);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMRightBorder");tr.appendChild(td);return item}CNavBar.prototype.itemChangeState=function(name,state){switch(state){case'out':this.m_items[name].m_itemcon.className="CNavBarItem";break;case'over':this.m_items[name].m_itemcon.className="CNavBarItemOver";break;case'on':this.m_items[name].m_itemcon.className="CNavBarItemOn";if(this.m_laston&&this.m_laston!=name)this.itemChangeState(this.m_laston,"out");this.m_laston=name;break}}CNavBar.prototype.itemClearOnStates=function(){for(item in this.m_items){this.itemChangeState(item,'out')}}CNavBar.prototype.addSectionDiv=function(){}CNavBar.prototype.getNavBar=function(){var div=ALib.m_document.createElement("div");this.m_con.appendChild(div);var tbl=ALib.m_document.createElement("table");div.appendChild(tbl);ALib.Dom.styleSet(tbl,"border","0px");ALib.Dom.styleSet(tbl,"width","100%");tbl.cellPadding='0';tbl.cellSpacing='0';var tblbdy=ALib.m_document.createElement("tbody");tbl.appendChild(tblbdy);var tr=ALib.m_document.createElement("tr");tblbdy.appendChild(tr);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMBorderBottom");tr.appendChild(td);return this.m_con}CNavBar.prototype.print=function(con){con.appendChild(this.getNavBar())}CNavBar.prototype.getNextItemId=function(){this.m_itemcounter++;var name="item_"+this.m_itemcounter;return name}CNavBar.prototype.getNextSectionId=function(){this.m_sectioncounter++;var name="section_"+this.m_sectioncounter;return name}CNavBar.prototype.addSection=function(label,idname){var name=(idname)?idname:this.getNextSectionId();this.m_lasesection=name;this.m_sections[name]=new CNavBarSection(this);var section=this.m_sections[name];section.m_idname=idname;section.m_div=ALib.m_document.createElement("div");this.m_con.appendChild(section.m_div);section.m_tbl=ALib.m_document.createElement("table");ALib.Dom.styleSet(section.m_tbl,"border","0px");ALib.Dom.styleSet(section.m_tbl,"width","100%");section.m_tbl.cellPadding='0';section.m_tbl.cellSpacing='0';section.m_tblbdy=ALib.m_document.createElement("tbody");section.m_tbl.appendChild(section.m_tblbdy);section.m_div.appendChild(section.m_tbl);var tr=ALib.m_document.createElement("tr");section.m_tblbdy.appendChild(tr);var td=ALib.m_document.createElement("td");tr.appendChild(td);var tbl=ALib.m_document.createElement("table");ALib.Dom.styleSet(tbl,"border","0px");ALib.Dom.styleSet(tbl,"width","100%");tbl.cellPadding=0;tbl.cellSpacing=0;td.appendChild(tbl);var tbody=ALib.m_document.createElement("tbody");tbl.appendChild(tbody);var tr=ALib.m_document.createElement("tr");tbody.appendChild(tr);var td=ALib.m_document.createElement("td");td.colSpan="3";ALib.Dom.StyleAddClass(td,"CTMHeaderTopHr");tr.appendChild(td);if(label){var tr=ALib.m_document.createElement("tr");tbody.appendChild(tr);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMLeftBorder");tr.appendChild(td);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMHeaderBody");ALib.Dom.styleSet(td,"font-weight","bold");td.innerHTML=label;tr.appendChild(td);var td=ALib.m_document.createElement("td");ALib.Dom.StyleAddClass(td,"CTMRightBorder");tr.appendChild(td)}return this.m_sections[name]}CNavBar.prototype.onExit=function(){}CNavBar.prototype.deleteItem=function(idname){var row=this.m_items[idname].m_linktd.parentNode;var tbl=row.parentNode;tbl.removeChild(row)}CNavBar.prototype.setItemLabel=function(idname,label){var dv=this.m_items[idname].m_linktd.childNodes.item(1);if(dv)dv.innerHTML=label}function CNavBarSection(nbobj){this.m_div=null;this.m_tbl=null;this.m_tblbdy=null;this.m_idname=null;this.m_nb=nbobj}CNavBarSection.prototype.addItem=function(label,icon,action,args,idname){return this.m_nb.addSectionItem(label,icon,action,args,idname,this.m_idname)}function CNavBarItem(nbobj){this.m_secname=null;this.m_tr=null;this.tilde_dv=null;this.icon_dv=null;this.link_dv=null;this.m_linktd=null;this.m_nb=nbobj;this.m_expanded=false;this.m_depth=0;this.m_parent=null;this.m_children=new Array()}CNavBarItem.prototype.addItem=function(label,icon,action,args,idname){var item=this.m_nb.addSectionItem(label,icon,action,args,idname,this.m_secname,(this.m_depth+1),this);item.m_parent=this;item.setHasChildren(false);this.m_children[this.m_children.length]=item;this.setHasChildren(true);return item}CNavBarItem.prototype.getOptionCon=function(){var dv=ALib.Dom.createElement("div");ALib.Dom.styleSet(dv,"float","right");insertAfter(this.m_itemcon,dv,this.m_linktd);return dv}CNavBarItem.prototype.getLabelCon=function(){return this.m_link}CNavBarItem.prototype.hide=function(){ALib.Dom.styleSet(this.m_tr,"display","none")}CNavBarItem.prototype.show=function(){if(ALib.m_browser.ie)ALib.Dom.styleSet(this.m_tr,"display","block");else ALib.Dom.styleSet(this.m_tr,"display","table-row")}CNavBarItem.prototype.setHasChildren=function(haschildren){if(!this.tilde_dv){this.tilde_dv=ALib.Dom.createElement("div");this.tilde_dv.m_node=this;this.tilde_dv.onclick=function(){if(this.m_node.m_expanded)this.m_node.collapse();else this.m_node.expand()}ALib.Dom.styleSet(this.tilde_dv,"float","left");this.m_itemcon.insertBefore(this.tilde_dv,this.m_icon)}if(haschildren){if(this.m_expanded)ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubOpen");else ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubClosed")}else{ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeNoSub")}}CNavBarItem.prototype.expand=function(){if(this.m_children.length){for(var i=0;i<this.m_children.length;i++)this.m_children[i].show();this.m_expanded=true;ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubOpen")}}CNavBarItem.prototype.collapse=function(){if(this.m_children.length){for(var i=0;i<this.m_children.length;i++){this.m_children[i].collapse();this.m_children[i].hide()}this.m_expanded=false;ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubClosed")}}CNavBarItem.prototype.deleteItem=function(){if(this.m_children.length);{for(var i=0;i<this.m_children.length;i++)this.m_children[i].deleteItem()}this.m_nb.deleteItem(this.m_idname);if(this.m_parent){if(this.m_parent.m_children.length<2)this.m_parent.haschildren(false)}}var g_CAdcClient=new Array();function CAdcClient(url,dbid){this.m_dbid=dbid;this.m_url=url;this.m_cols=new Array();this.m_ind=g_CAdcClient.length}CAdcClient.prototype.query=function(query){g_CAdcClient[this.m_ind]=null;g_CAdcClient[this.m_ind]=new CAjax();this.m_cols=null;this.m_cols=new Array();g_CAdcClient[this.m_ind].m_dbh=this;g_CAdcClient[this.m_ind].onload=function(){var retval=null;var root=this.m_firstNode;var num=root.getNumChildren();for(i=0;i<num;i++){var child=root.getChildNode(i);if(child.m_name=="retval"){if(child.m_text){this.m_dbh.retval=unescape(child.m_text)}}if(child.m_name=="collist"){var num_cols=child.getNumChildren();for(j=0;j<num_cols;j++){var cols=child.getChildNode(j);if(cols.m_name=="column"){var num_vars=cols.getNumChildren();var name=null;var type_name=null;var type=null;var notes=null;for(m=0;m<num_vars;m++){var colattr=cols.getChildNode(m);switch(colattr.m_name){case"name":name=(colattr.m_text)?unescape(colattr.m_text):"";break;case"type_name":type_name=(colattr.m_text)?unescape(colattr.m_text):"";break;case"type":type=(colattr.m_text)?unescape(colattr.m_text):"";break;case"notes":notes=(colattr.m_text)?unescape(colattr.m_text):"";break}}if(name){var ind=this.m_dbh.m_cols.length;this.m_dbh.m_cols[ind]=new Object();this.m_dbh.m_cols[ind].name=name;this.m_dbh.m_cols[ind].notes=notes;this.m_dbh.m_cols[ind].data_type=type_name;this.m_dbh.m_cols[ind].type=type}}}}if(child.m_name=="dataset"){if(child.getNumChildren())this.m_dbh.m_dataset=child}}this.m_dbh.onload()};g_CAdcClient[this.m_ind].exec(this.m_url+"?dbid="+this.m_dbid+"&query="+escape(query))}CAdcClient.prototype.getNumRows=function(){if(this.m_dataset)return this.m_dataset.getNumChildren();else return 0}CAdcClient.prototype.onload=function(){}CAdcClient.prototype.getValue=function(row,col){if(this.getNumRows()>row&&this.getNumCols()>col){try{if(this.m_dataset.getChildNode(row))return this.m_dataset.getChildNode(row).getChildNode(col).m_text}catch(e){}}}CAdcClient.prototype.getNamedValue=function(row,colname){if(this.getNumRows()>row){try{if(this.m_dataset.getChildNode(row)){var num=this.m_cols.length;for(var i=0;i<num;i++){if(this.m_cols[i].name==colname)return this.m_dataset.getChildNode(row).getChildNode(i).m_text}}}catch(e){}}return""}CAdcClient.prototype.getNumCols=function(){return this.m_cols.length}CAdcClient.prototype.getColName=function(colind){return this.m_cols[colind].name}CAdcClient.prototype.getCol=function(colind){return this.m_cols[colind]}CAdcClient.prototype.getColIndex=function(colname){}CAdcClient.prototype.escape=function(text){if(text){var myRegExp=/[']/g;return text.replace(myRegExp,"\\'")}else return text}function CSplitContainer(orientation,width,height){this.m_orientation=(orientation)?orientation:"verticle";this.m_document=ALib.m_document;this.m_con=this.m_document.createElement("div");this.m_tbl=this.m_document.createElement("table");if(width)ALib.Dom.styleSet(this.m_tbl,"width",width);else ALib.Dom.styleSet(this.m_tbl,"width","100%");if(height)ALib.Dom.styleSet(this.m_tbl,"height",height);this.m_tbl.setAttribute("cellpadding","0");this.m_tbl.cellPadding="0";this.m_tbl.setAttribute("cellspacing","0");this.m_tbl.cellSpacing="0";this.m_con.appendChild(this.m_tbl);this.m_tbody=this.m_document.createElement("tbody");this.m_tbl.appendChild(this.m_tbody);if(height)ALib.Dom.styleSet(this.m_tbody,"height",height);if(this.m_orientation=="verticle"){this.m_row=this.m_document.createElement("tr");this.m_tbody.appendChild(this.m_row)}this.resizable=false;this.m_columns=new Array();this.onPanelResize=new Function();this.onPanelResizeStart=new Function()}CSplitContainer.prototype.addPanel=function(size,overflow){if(this.m_columns.length>=1&&this.resizable){var res_dv=this.m_document.createElement("td");if(this.m_orientation=="verticle"){ALib.Dom.styleSetClass(res_dv,"CSplitContainerVertResizeBar");res_dv.onmouseover=function(){ALib.Dom.styleSetClass(this,"CSplitContainerVertResizeBarOver")};res_dv.onmouseout=function(){ALib.Dom.styleSetClass(this,"CSplitContainerVertResizeBar")};this.m_row.appendChild(res_dv)}else{ALib.Dom.styleSetClass(res_dv,"CSplitContainerHorizResizeBar");res_dv.onmouseover=function(){ALib.Dom.styleSetClass(this,"CSplitContainerHorizResizeBarOver")};res_dv.onmouseout=function(){ALib.Dom.styleSetClass(this,"CSplitContainerHorizResizeBar")};this.m_row=this.m_document.createElement("tr");this.m_row.appendChild(res_dv);this.m_tbody.appendChild(this.m_row)}}var col_dv=this.m_document.createElement("td");ALib.Dom.styleSet(col_dv,"vertical-align","top");if(overflow)ALib.Dom.styleSet(col_dv,"overflow",overflow);if(this.m_orientation=="verticle"){if(size!="*"&&size!=""){ALib.Dom.styleSet(col_dv,"width",size)}this.m_row.appendChild(col_dv)}else{if(size!="*"&&size!=""){ALib.Dom.styleSet(col_dv,"height",size)}this.m_row=this.m_document.createElement("tr");this.m_row.appendChild(col_dv);this.m_tbody.appendChild(this.m_row)}this.m_columns[this.m_columns.length]=col_dv;if(res_dv){if(this.m_orientation=="verticle"){DragAndDrop.registerDragable(res_dv);res_dv.m_cls=this;res_dv.m_leftcon=this.m_columns[this.m_columns.length-2];res_dv.m_rightcon=this.m_columns[this.m_columns.length-1];res_dv.onDragStart=function(x,y){this.minY=y;this.maxY=y;this.startX=x;var l_pos=ALib.Dom.getElementPosition(this.m_leftcon);var r_pos=ALib.Dom.getElementPosition(this.m_rightcon);this.minX=l_pos.x;this.maxX=r_pos.r-this.offsetWidth;this.m_leftConWidth=this.m_leftcon.offsetWidth;this.m_rightConWidth=this.m_rightcon.offsetWidth;ALib.Dom.styleSetClass(this.m_dragCon,"CSplitContainerVertResizeBarOver");this.m_cls.onPanelResizeStart()};res_dv.onDrag=function(x,y){var change=x-this.startX;var l=(this.m_leftConWidth+change);var r=(this.m_rightConWidth+(change*-1));ALib.Dom.styleSet(this.m_leftcon,"width",l+"px");ALib.Dom.styleSet(this.m_rightcon,"width",r+"px")};res_dv.onDragEnd=function(x,y){this.m_cls.onPanelResize()}}else{DragAndDrop.registerDragable(res_dv);res_dv.m_cls=this;res_dv.m_topcon=this.m_columns[this.m_columns.length-2];res_dv.m_bottomcon=this.m_columns[this.m_columns.length-1];res_dv.onDragStart=function(x,y){this.minX=x;this.maxX=x;this.startY=y;var t_pos=ALib.Dom.getElementPosition(this.m_topcon);var b_pos=ALib.Dom.getElementPosition(this.m_bottomcon);this.minY=t_pos.y;this.maxY=b_pos.b-this.offsetHeight;this.m_topConHeight=this.m_topcon.offsetHeight;this.m_bottomConHeight=this.m_bottomcon.offsetHeight;ALib.Dom.styleSetClass(this.m_dragCon,"CSplitContainerHorizResizeBarOver");this.m_cls.onPanelResizeStart()};res_dv.onDrag=function(x,y){var change=y-this.startY;var t=(this.m_topConHeight+change);var b=(this.m_bottomConHeight+(change*-1));ALib.Dom.styleSet(this.m_topcon,"height",t+"px");ALib.Dom.styleSet(this.m_bottomcon,"height",b+"px")};res_dv.onDragEnd=function(x,y){this.m_cls.onPanelResize()}}}return col_dv}CSplitContainer.prototype.getPanelCon=function(indx){return this.m_columns[indx]}CSplitContainer.prototype.print=function(con){con.appendChild(this.m_con)}function CTabs(){this.m_document=ALib.m_document;var doc=this.m_document;this.m_outerdv=doc.createElement("div");this.m_navrow=doc.createElement("div");this.m_outerdv.appendChild(this.m_navrow);var tbl=doc.createElement("table");this.m_navrow.appendChild(tbl);tbl.setAttribute("cellpadding","0");tbl.cellPadding="0";tbl.setAttribute("cellspacing","0");tbl.cellSpacing="0";var tbl_bdy=doc.createElement("tbody");tbl.appendChild(tbl_bdy);this.m_tabrow=doc.createElement("tr");tbl_bdy.appendChild(this.m_tabrow);var dv=this.m_document.createElement("div");ALib.Dom.styleSetClass(dv,"CTTabHr");this.m_outerdv.appendChild(dv);this.m_con=this.m_document.createElement("div");this.m_outerdv.appendChild(this.m_con);this.m_pages=new Array();this.m_next_index=0;this.m_default_index=0}CTabs.prototype.addTab=function(label,clk_act){this.m_pages[this.m_next_index]=new Object();this.m_pages[this.m_next_index].label=label;this.m_pages[this.m_next_index].ind=this.m_next_index;if(clk_act)this.m_pages[this.m_next_index].clk_act=clk_act;this.m_pages[this.m_next_index].container=this.m_document.createElement("div");this.m_pages[this.m_next_index].td_l=this.m_document.createElement("td");this.m_tabrow.appendChild(this.m_pages[this.m_next_index].td_l);this.m_pages[this.m_next_index].td_b=this.m_document.createElement("td");this.m_pages[this.m_next_index].td_b.innerHTML=label;this.m_tabrow.appendChild(this.m_pages[this.m_next_index].td_b);var me=this;this.m_pages[this.m_next_index].td_b.m_cls=me;this.m_pages[this.m_next_index].td_b.m_ind=this.m_next_index;this.m_pages[this.m_next_index].td_b.onclick=function(){this.m_cls.selectTab(this.m_ind)}this.m_pages[this.m_next_index].td_r=this.m_document.createElement("td");this.m_tabrow.appendChild(this.m_pages[this.m_next_index].td_r);if(this.m_next_index!=this.m_default_index){ALib.Dom.styleSet(this.m_pages[this.m_next_index].container,"display","none");this.setTabState(this.m_next_index,"off")}else{this.setTabState(this.m_next_index,"on")}this.m_con.appendChild(this.m_pages[this.m_next_index].container);ALib.Dom.styleSetClass(this.m_pages[this.m_next_index].container,"CTTabBody");var lastind=this.m_next_index;this.m_next_index++;return this.m_pages[lastind].container}CTabs.prototype.selectTab=function(indx){if(this.m_lasttab)this.setTabState(this.m_lasttab,"off");else this.setTabState(this.m_default_index,"off");this.setTabState(indx,"on");this.m_lasttab=indx}CTabs.prototype.setTabState=function(tabind,state){switch(state){case'on':ALib.Dom.styleSetClass(this.m_pages[tabind].td_l,"CTTabLeftOn");ALib.Dom.styleSetClass(this.m_pages[tabind].td_b,"CTTabCenterOn");ALib.Dom.styleSetClass(this.m_pages[tabind].td_r,"CTTabRightOn");ALib.Dom.styleSet(this.m_pages[tabind].container,"display","block");break;case'off':ALib.Dom.styleSetClass(this.m_pages[tabind].td_l,"CTTabLeftOff");ALib.Dom.styleSetClass(this.m_pages[tabind].td_b,"CTTabCenterOff");ALib.Dom.styleSetClass(this.m_pages[tabind].td_r,"CTTabRightOff");ALib.Dom.styleSet(this.m_pages[tabind].container,"display","none");break}}CTabs.prototype.getPageCon=function(ind){return this.m_pages[ind].container}CTabs.prototype.print=function(container){if(container)container.appendChild(this.m_outerdv);else document.write(this.m_table.outerHTML)}CTabs.prototype.getTabHeight=function(){return this.m_navrow.offsetHeight}function CToolbar(){this.m_document=ALib.m_document;var doc=this.m_document;this.m_outerdv=doc.createElement("div");var tbl=doc.createElement("table");this.m_table=tbl;ALib.Dom.styleSetClass(tbl,"CToolbar");ALib.Dom.styleSet(tbl,"width","100%");tbl.setAttribute("cellpadding","0");tbl.cellPadding="0";tbl.setAttribute("cellspacing","0");tbl.cellSpacing="0";var tbl_bdy=doc.createElement("tbody");tbl.appendChild(tbl_bdy);var row=doc.createElement("tr");tbl_bdy.appendChild(row);var td=doc.createElement("td");row.appendChild(td);this.m_con=td;this.m_outerdv.appendChild(tbl)}CToolbar.prototype.AddItem=function(element,align){var dv=this.m_document.createElement("div");if(align=="right"){ALib.Dom.styleSet(dv,"float","right");ALib.Dom.styleSet(dv,"padding-right","2px")}else{ALib.Dom.styleSet(dv,"float","left");ALib.Dom.styleSet(dv,"padding-left","2px")}dv.appendChild(element);this.m_con.appendChild(dv)}CToolbar.prototype.addSpacer=function(align){var dv=this.m_document.createElement("div");if(align=="right"){ALib.Dom.styleSet(dv,"float","right")}else{ALib.Dom.styleSet(dv,"float","left")}ALib.Dom.styleSetClass(dv,"CToolbarSpacer");this.m_con.appendChild(dv)}CToolbar.prototype.addIcon=function(src,align,funct,fargs){var dv=this.m_document.createElement("div");ALib.Dom.styleSetClass(dv,"CToolbarIcon");if(align=="right"){ALib.Dom.styleSet(dv,"float","right")}else{ALib.Dom.styleSet(dv,"float","left")}dv.innerHTML="<img src='"+src+"' border='0'>";dv.functname=funct;dv.onclick=function(){if(typeof this.functname!="string"){if(typeof fargs!="undefined"&&fargs){switch(fargs.length){case 1:this.functname(fargs[0]);break;case 2:this.functname(fargs[0],fargs[1]);break;case 3:this.functname(fargs[0],fargs[1],fargs[2]);break;case 4:this.functname(fargs[0],fargs[1],fargs[2],fargs[3]);break;case 5:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4]);break;case 6:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5]);break;case 7:this.functname(fargs[0],fargs[1],fargs[2],fargs[3],fargs[4],fargs[5],fargs[6]);break}}else this.functname()}}this.m_con.appendChild(dv)}CToolbar.prototype.print=function(dv){if(dv)dv.appendChild(this.m_outerdv);else document.write(this.m_outerdv.outerHTML)}CToolbar.prototype.getContainer=function(){return this.m_con}CToolbar.prototype.setClass=function(cls){ALib.Dom.styleSetClass(this.m_table,cls)}var g_ctt_tind=0;var g_ctt_tables=new Array();function CToolTable(width,height,custom_class){var table=ALib.m_document.createElement("table");if(custom_class)table.className=custom_class;else table.className="CTTMainTable";table.setAttribute("cellpadding","0");table.cellPadding="0";table.setAttribute("cellspacing","0");table.cellSpacing="0";table.setAttribute("border","0");table.border="0";if(width)table.style.width=width;if(height)table.style.height=height;var tbl_body=ALib.m_document.createElement("TBODY")table.appendChild(tbl_body);this.m_table=table;this.m_table_body=tbl_body;this.m_numrows=0;this.m_rows=new Array();this.m_rowBody=null;this.m_rowSpacer=null;this.m_headersrow=null;this.m_uni_id="alib_ctt_"+g_ctt_tind;g_ctt_tables[g_ctt_tind]=this;g_ctt_tind++}CToolTable.prototype.addHeader=function(name,align,width,height,custom_class,custom_padding){if(!align)var align="left";if(showspacer=="undefined")var showspacer=true;if(!this.m_headersrow){this.m_headersrow=ALib.m_document.createElement("tr");this.m_table_body.appendChild(this.m_headersrow)}var td=ALib.m_document.createElement("td");td.innerHTML=name;td.className=(custom_class)?custom_class:"CTTHeaderCell";td.align=align;td.setAttribute("align",align);if(width)td.style.width=width;if(height)td.style.height=height;td.style.padding=(custom_padding)?custom_padding:"3px 5px 3px 5px";this.m_headersrow.appendChild(td);return td}CToolTable.prototype.addRow=function(idname){var name=(idname)?idname:this.m_numrows;this.m_lastRow=name;this.m_rows[name]=new CToolTableRow();this.m_rows[name].m_hinst=this;this.m_rows[name].m_name=name;this.m_rows[name].m_uni_id=this.m_uni_id+"_row_"+name;this.m_rowSpacer=ALib.m_document.createElement("tr");this.m_rowBody=ALib.m_document.createElement("tr");this.m_rowBody.valign="top";this.m_rowBody.setAttribute("valign","top");this.m_table_body.appendChild(this.m_rowSpacer);this.m_table_body.appendChild(this.m_rowBody);this.m_rows[name].m_rowSpacer=this.m_rowSpacer;this.m_rows[name].m_row=this.m_rowBody;this.m_numrows++;return this.m_rows[name]}CToolTable.prototype.numRows=function(){return this.m_numrows}CToolTable.prototype.startRow=function(){this.addRow()}CToolTable.prototype.endRow=function(){}CToolTable.prototype.clear=function(){for(var row in this.m_rows){this.removeRow(row)}}CToolTable.prototype.removeRow=function(indx){try{this.m_table_body.removeChild(this.m_rows[indx].m_rowSpacer);this.m_table_body.removeChild(this.m_rows[indx].m_row);this.m_numrows=this.m_numrows-1}catch(e){}}CToolTable.prototype.addCell=function(content,bold,align,width,height,custom_class,custom_padding,indx){var name=(indx)?indx:this.m_lastRow;var cellclass="";if(this.m_numrows%2)cellclass=(bold)?"CTTRowOneBold":"CTTRowOne";else cellclass=(bold)?"CTTRowTwoBold":"CTTRowTwo";var td_spacer=ALib.m_document.createElement("td");td_spacer.className="CTTRowSpacer";this.m_rows[name].m_rowSpacer.appendChild(td_spacer);var td_body=ALib.m_document.createElement("td");td_body.className=(custom_class)?custom_class:cellclass;td_body.align=(align)?align:"left";td_body.style.padding=(custom_padding)?custom_padding:"3px 5px 3px 5px";if(width)td_body.style.width=width;if(height)td_body.style.width=height;if(typeof content=="string")td_body.innerHTML=content;else{try{td_body.appendChild(content)}catch(e){}}this.m_rows[name].m_row.appendChild(td_body);return td_body}CToolTable.prototype.print=function(div_parent){if(div_parent){this.m_parentdiv=div_parent;div_parent.appendChild(this.m_table)}else document.write(this.m_table.outerHTML)}function CToolTableRow(){this.m_row;this.m_rowSpacer;this.m_hinst;this.m_name;this.m_uni_id=null}CToolTableRow.prototype.addCell=function(content,bold,align,width,height,custom_class,custom_padding){if(!content)var content=null;if(!bold)var bold=null;if(!align)var align=null;if(!width)var width=null;if(!height)var height=null;if(!custom_class)var custom_class=null;if(!custom_padding)var custom_padding=null;this.m_hinst.addCell(content,bold,align,width,height,custom_class,custom_padding,this.m_name)}CToolTableRow.prototype.deleteRow=function(){this.m_hinst.removeRow(this.m_name)}CToolTableRow.prototype.getId=function(){return this.m_uni_id}function CWindowFrame(label,width,padding){this.m_div=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(this.m_div,"CWindowFrameOuter");if(width)ALib.Dom.styleSet(this.m_div,"width",width);if(label){var lbl_div=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(lbl_div,"CWindowFrameLabel");lbl_div.innerHTML=label;this.m_div.appendChild(lbl_div)}var cell_pad=(padding)?padding:'3px';this.m_con_div=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(this.m_con_div,"CWindowFrameContent");ALib.Dom.styleSet(this.m_con_div,"padding",cell_pad);this.m_div.appendChild(this.m_con_div)}CWindowFrame.prototype.getCon=function(){return this.m_con_div}CWindowFrame.prototype.getFrame=function(){return this.m_div}CWindowFrame.prototype.print=function(div_parent){if(div_parent)div_parent.appendChild(this.getFrame());else document.write(this.m_div.outerHTML)}function CAlib(){this.m_appcontainer=null;this.m_browser=new CBrowserInfo();this.Dom=new CDom();this.Effect=new CEffect();this.Dlg=new CDialog();this.setDocument();this.m_evwnd=window;this.m_debug=false}CAlib.prototype.setDocument=function(doc){this.Dom.m_binfo=this.m_browser;this.Dom.m_browser=this.m_browser;this.Effect.m_browser=this.m_browser;if(doc){this.m_document=doc;this.Dom.setCurrentDoc(doc)}else{this.m_document=document;this.Dom.setCurrentDoc(document)}}CAlib.prototype.statusShowAlert=function(content,timeout,valign,halign){var vert_align=(valign)?valign:'middle';var horiz_align=(halign)?halign:'center';if(!this.m_alert_id)this.m_alert_id=0;try{this.m_alert_id++;var dv_status=this.m_document.createElement('div');dv_status.id="alib_statusalert_"+this.m_alert_id;this.Dom.styleSet(dv_status,"position","absolute");this.Dom.styleSet(dv_status,"top","150px");this.Dom.styleSet(dv_status,"visibility","hidden");if(typeof content=="string"||typeof content=="number")dv_status.innerHTML=content;else dv_status.appendChild(content);this.m_document.body.appendChild(dv_status);var ht=dv_status.offsetHeight;var wd=dv_status.offsetWidth;var sptop=this.Dom.getScrollPosTop();var spleft=this.Dom.getScrollPosLeft();switch(vert_align){case"top":var tp=sptop+3;break;case"middle":var tp=sptop+((this.Dom.getClientHeight()-ht)/2)-12;break;case"bottom":var tp=sptop+(this.Dom.getClientHeight()-ht)-12;break}switch(horiz_align){case"left":var lt=spleft+3;break;case"center":var lt=spleft+((this.Dom.getClientWidth()-wd)/2)-12;break;case"right":var lt=spleft+(this.Dom.getClientWidth()-wd)-12;break}this.Dom.styleSet(dv_status,"left",lt+"px");this.Dom.styleSet(dv_status,"top",tp+"px");this.Effect.fadein(dv_status,200);this.Dom.styleSet(dv_status,"visibility","visible");if(timeout){var fctn=function(){dv_status.onfaded=function(){ALib.Dom.styleSet(this,"visibility","hidden")}ALib.Effect.fade(dv_status,200)};window.setTimeout(fctn,timeout)}}catch(e){}return dv_status}CAlib.prototype.statusHideAlert=function(dv_status){try{ALib.Dom.styleSet(dv_status,"visibility","hidden")}catch(e){}}CAlib.prototype.trace=function(txt){try{if(!this.m_debug)return;if(!this.m_debug_wnd||!this.m_debug_wnd.document){var attribs='top=200,left=100,width=450,height=350,toolbar=no,menubar=no,scrollbars=yes,'+'location=no,directories=no,status=no,resizable=yes';this.m_debug_wnd=window.open('about:blank','ALIB Debuger',attribs);var frameHtml="<!DOCTYPE html PUBLIC ";frameHtml+="\"-//W3C//DTD XHTML 1.0 Strict//EN\" ";frameHtml+="\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">";frameHtml+="\n";frameHtml+="<html>\n";frameHtml+="<head>\n";frameHtml+="<title>ALib Debugger</title>\n";frameHtml+="</head>\n";frameHtml+="<body id='debugger' style='color: white; background-color: black;'>\n";frameHtml+="</body>\n";frameHtml+="</html>";this.m_debug_wnd.document.open();this.m_debug_wnd.document.write(frameHtml);this.m_debug_wnd.document.close()}var dv=this.m_debug_wnd.document.createElement("div");dv.innerHTML=txt;this.m_debug_wnd.document.body.appendChild(dv)}catch(e){}}var ALib=new CAlib();if(typeof insertAfter=="undefined"){function insertAfter(parent,node,referenceNode){if(referenceNode.nextSibling)parent.insertBefore(node,referenceNode.nextSibling);else parent.appendChild(node)}}if(typeof(Math.sqr)=="undefined"){Math.sqr=function(x){return x*x}}function rgb2hex(value){var x=255;var hex='';var i;var regexp=/([0-9]+)[, ]+([0-9]+)[, ]+([0-9]+)/;var array=regexp.exec(value);for(i=1;i<4;i++)hex+=('0'+parseInt(array[i]).toString(16)).slice(-2);return'#'+hex}function encode_utf8(s){return unescape(encodeURIComponent(s))}function escape_utf8(s){return encodeURIComponent(s)}function decode_utf8(s){return decodeURIComponent(escape(s))}function unescape_utf8(s){return decodeURIComponent(s)}function CUsageTracking(server,dbid,page){var send_vars=new Array();var path="http://"+server+"/datacenter/svr_logwebusage.awp";try{var doc=(typeof ALib!="undefined")?ALib.m_document:document}catch(e){var doc=document}if(!page){var page=doc.location.href;var i=page.indexOf("://");if(i){page=page.substring(i+3,page.length);i=page.indexOf("/");if(i)page=page.substring(i+1,page.length);if("index.htm"==page||"index.html"==page||"index.php"==page||"index.awp"==page||""==page){page="/"}send_vars[send_vars.length]=["page",page]}}else{send_vars[send_vars.length]=["page",page]}var referrer=doc.referrer;if(referrer){send_vars[send_vars.length]=["referrer",referrer]}var ses=CUTReadCookie("ant_cut_ses");var ret=CUTReadCookie("ant_cut_ret");if(!ses){send_vars[send_vars.length]=["logvisit",'1'];var visit_type=(ret)?2:1;send_vars[send_vars.length]=["visit_type",visit_type];CUTCreateCookie("ant_cut_ses","1",null);CUTCreateCookie("ant_cut_ret","1",90)}send_vars[send_vars.length]=["dbid",dbid];path+="?";var tmpVars="function=log";for(var i=0;i<send_vars.length;i++){tmpVars+="&"+send_vars[i][0]+"="+escape(send_vars[i][1])}var img=new Image(1,1);img.src=path+tmpVars;img.onload=function(){}}function CUTCreateCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"}function CUTReadCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}function CUTEraseCookie(name){createCookie(name,"",-1)}function CTreeView(){this.m_nodes=new Array();this.m_outercon=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(this.m_outercon,"CTreeViewCon")}CTreeView.prototype.addNode=function(title,icon,action){if(typeof icon=="undefined")var icon=null;if(typeof action=="undefined")var action=null;this.m_nodes[this.m_nodes.length]=new CTreeViewNode(this.m_outercon,1,title,icon,action);return this.m_nodes[this.m_nodes.length-1]}CTreeView.prototype.getTvNodeById=function(id,pnt){var parent_node=(pnt)?pnt:this;for(var i=0;i<parent_node.m_nodes.length;i++){ALib.trace("CTreeView: getTvNodeById - checking "+id+" against "+parent_node.m_nodes[i].id);if(parent_node.m_nodes[i].id==id)return parent_node.m_nodes[i];var tmpnd=this.getTvNodeById(id,parent_node.m_nodes[i]);if(tmpnd)return tmpnd}return null}CTreeView.prototype.print=function(container){if(typeof container!="undefined"&&container)container.appendChild(this.m_outercon);else document.write(this.m_outercon.outerHTML)}function CTreeViewNode(con,depth,title,icon,action,args,parent_node){this.m_expanded=false;this.id=null;this.m_title=(typeof title!="undefined")?title:"";this.m_icon=(typeof icon!="undefined")?icon:"";this.m_depth=depth;this.m_outercon=con;if(parent_node)this.m_parent=parent_node;else this.m_parent=null;this.registerDropzone=null;this.onDragEnter=null;this.onDragExit=null;this.onDragDrop=null;this.m_nodes=new Array();this.m_row=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(this.m_row,"CTreeViewRow");if(this.m_parent){var after=null;if(this.m_parent.m_nodes.length){insertAfter(con,this.m_row,this.m_parent.getLastChildNode().m_row)}else{insertAfter(con,this.m_row,this.m_parent.m_row)}this.m_nodes[this.m_nodes.length]}else con.appendChild(this.m_row);for(var i=1;i<depth;i++){var dv=ALib.m_document.createElement("div");ALib.Dom.styleSet(dv,"float","left");ALib.Dom.styleSetClass(dv,"CTreeViewSpaceLine");this.m_row.appendChild(dv)}this.tilde_dv=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeNoSub");ALib.Dom.styleSet(this.tilde_dv,"float","left");this.tilde_dv.m_node=this;this.tilde_dv.onclick=function(){if(this.m_node.m_expanded)this.m_node.collapse();else this.m_node.expand()}this.m_row.appendChild(this.tilde_dv);var dv=ALib.m_document.createElement("div");ALib.Dom.styleSetClass(dv,"CTreeViewIcon");ALib.Dom.styleSet(dv,"float","left");this.m_row.appendChild(dv);if(this.m_icon)dv.innerHTML="<img src='"+this.m_icon+"' border='0' />";this.m_bodydv=ALib.m_document.createElement("div");ALib.Dom.styleSet(this.m_bodydv,"display","inline");ALib.Dom.styleSetClass(this.m_bodydv,"CTreeViewBodyOut");this.m_row.appendChild(this.m_bodydv);this.m_bodydv.innerHTML="<span>"+this.m_title+"</span>";var cdiv=ALib.m_document.createElement("div");ALib.Dom.styleSet(cdiv,"clear","both");this.m_row.appendChild(cdiv);if(action){if(args)this.setAction(action,args);else this.setAction(action)}this.setMouseHandlers(true);if(depth>1){if(parent_node&&parent_node.m_expanded){this.show()}else this.hide()}}CTreeViewNode.prototype.setAction=function(action,args){if(action){ALib.Dom.styleSet(this.m_bodydv,"cursor","pointer");if(typeof action=="string"){this.m_bodydv.m_actstr=action;this.m_bodydv.onclick=function(){eval(this.m_actstr)}}else{this.m_bodydv.cb_function=action;this.m_bodydv.m_cb_args=args;this.m_bodydv.onclick=function(){if(this.m_cb_args){switch(this.m_cb_args.length){case 1:this.cb_function(this.m_cb_args[0]);break;case 2:this.cb_function(this.m_cb_args[0],this.m_cb_args[1]);break;case 3:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2]);break;case 4:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3]);case 5:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4]);case 6:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5]);case 7:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6]);case 8:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7]);break;case 9:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7],this.m_cb_args[8]);case 10:this.cb_function(this.m_cb_args[0],this.m_cb_args[1],this.m_cb_args[2],this.m_cb_args[3],this.m_cb_args[4],this.m_cb_args[5],this.m_cb_args[6],this.m_cb_args[7],this.m_cb_args[8],this.m_cb_args[9]);break}}else{this.cb_function()}}}}}CTreeViewNode.prototype.addNode=function(title,icon,action,args){if(typeof icon=="undefined")var icon=null;if(typeof action=="undefined")var action=null;if(typeof args=="undefined")var args=null;this.m_nodes[this.m_nodes.length]=new CTreeViewNode(this.m_outercon,this.m_depth+1,title,icon,action,args,this);this.setHasChildren(true);return this.m_nodes[this.m_nodes.length-1]}CTreeViewNode.prototype.editBody=function(){var bdy=this.m_bodydv.childNodes.item(0);var buf=bdy.innerHTML;bdy.innerHTML="";var inp=ALib.m_document.createElement("input");ALib.Dom.styleSet(inp,"height","100%");inp.value=buf;inp.m_node=this;inp.onblur=function(){var val=this.value;this.m_node.m_bodydv.childNodes.item(0).innerHTML=val;this.m_node.onBodyEdit(val)}bdy.appendChild(inp);inp.select();inp.focus()}CTreeViewNode.prototype.onBodyEdit=function(val){}CTreeViewNode.prototype.setBody=function(val){this.m_bodydv.childNodes.item(0).innerHTML=val}CTreeViewNode.prototype.createContextMenu=function(){this.setMouseHandlers(false);var dm=new CDropdownMenu();dm.createContextMenu(this.m_bodydv,"CTreeViewBodyOut","CTreeViewBodyOver","CTreeViewBodyOn");return dm}CTreeViewNode.prototype.setHasChildren=function(haschildren){if(haschildren){if(this.m_expanded)ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubOpen");else ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubClosed")}else ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeNoSub")}CTreeViewNode.prototype.getLastChildNode=function(){var last=null;if(this.m_nodes.length)last=this.m_nodes[this.m_nodes.length-1].getLastChildNode();else last=this;return last}CTreeViewNode.prototype.hide=function(){ALib.Dom.styleSet(this.m_row,"display","none")}CTreeViewNode.prototype.show=function(){ALib.Dom.styleSet(this.m_row,"display","block")}CTreeViewNode.prototype.expand=function(){if(this.m_nodes.length){for(var i=0;i<this.m_nodes.length;i++)this.m_nodes[i].show();this.m_expanded=true;ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubOpen")}}CTreeViewNode.prototype.collapse=function(){if(this.m_nodes.length){for(var i=0;i<this.m_nodes.length;i++){this.m_nodes[i].collapse();this.m_nodes[i].hide()}this.m_expanded=false;ALib.Dom.styleSetClass(this.tilde_dv,"CTreeViewTildeWithSubClosed")}}CTreeViewNode.prototype.deleteNode=function(node){if(this.m_nodes.length){for(var i=0;i<this.m_nodes.length;i++){if(this.m_nodes[i]==node){this.m_nodes[i]=null;this.m_nodes.splice(i,1);break}}if(!this.m_nodes.length)this.setHasChildren(false)}}CTreeViewNode.prototype.remove=function(){if(this.m_nodes.length){for(var i=0;i<this.m_nodes.length;i++)this.m_nodes[i].remove()}this.m_outercon.removeChild(this.m_row);this.m_parent.deleteNode(this)}CTreeViewNode.prototype.setMouseHandlers=function(set){var funover=function(){ALib.Dom.styleSetClass(this,"CTreeViewBodyOver")}var funout=function(){ALib.Dom.styleSetClass(this,"CTreeViewBodyOut")}if(set){if(ALib.Dom.m_binfo.ie){this.m_bodydv.attachEvent('mouseover',funover);this.m_bodydv.attachEvent('mouseout',funout)}else{this.m_bodydv.addEventListener('mouseover',funover,false);this.m_bodydv.addEventListener('mouseout',funout,false)}}else{if(ALib.Dom.m_binfo.ie){this.m_bodydv.detachEvent('mouseover',funover);this.m_bodydv.detachEvent('mouseout',funout)}else{this.m_bodydv.removeEventListener('mouseover',funover,false);this.m_bodydv.removeEventListener('mouseout',funout,false)}}}function CDialog(title){if(title)this.m_title=title;else this.m_title=null;this.m_initialized=false}CDialog.prototype.fixSizeAndScroll=function(){ALib.m_evwnd.onscroll=this.scrollFix;ALib.m_evwnd.onresize=this.sizeFix}CDialog.prototype.posLeft=function(){return typeof ALib.m_evwnd.pageXOffset!='undefined'?ALib.m_evwnd.pageXOffset:ALib.m_document.documentElement&&ALib.m_document.documentElement.scrollLeft?ALib.m_document.documentElement.scrollLeft:ALib.m_document.body.scrollLeft?ALib.m_document.body.scrollLeft:0}CDialog.prototype.posTop=function(){return typeof ALib.m_evwnd.pageYOffset!='undefined'?ALib.m_evwnd.pageYOffset:ALib.m_document.documentElement&&ALib.m_document.documentElement.scrollTop?ALib.m_document.documentElement.scrollTop:ALib.m_document.body.scrollTop?ALib.m_document.body.scrollTop:0}CDialog.prototype.gete=function(x){return ALib.m_document.getElementById(x)}CDialog.prototype.scrollFix=function(){var obol=this.overlay;if(obol){obol.style.top=ALib.Dom.getScrollPosTop()+'px';obol.style.left=ALib.Dom.getScrollPosLeft()+'px'}}CDialog.prototype.sizeFix=function(){var obol=this.overlay;if(obol){obol.style.height=ALib.Dom.GetDocumentHeight()+'px';obol.style.width=ALib.Dom.getDocumentWidth()+'px'}}CDialog.prototype.kp=function(e){ky=e?e.which:event.keyCode;if(ky==88||ky==120)this.hm();return false}CDialog.prototype.inf=function(h){tag=ALib.m_document.getElementsByTagName('select');for(i=tag.length-1;i>=0;i--)tag[i].style.visibility=h;tag=ALib.m_document.getElementsByTagName('iframe');for(i=tag.length-1;i>=0;i--)tag[i].style.visibility=h;tag=ALib.m_document.getElementsByTagName('object');for(i=tag.length-1;i>=0;i--)tag[i].style.visibility=h}CDialog.prototype.show=function(wd,ht){this.sm(wd,ht)}CDialog.prototype.sm=function(wd,ht){var h='hidden';var b='block';var p='px';this.overlay.style.height=ALib.Dom.getDocumentHeight()+p;this.overlay.style.width=ALib.Dom.getDocumentWidth()+p;this.overlay.style.top="0px";this.overlay.style.left="0px";this.overlay.style.display=b;var sptop=ALib.Dom.getScrollPosTop();var spleft=ALib.Dom.getScrollPosLeft();var tp=sptop+((ALib.Dom.getClientHeight()-ht)/2)-12;var lt=spleft+((ALib.Dom.getClientWidth()-wd)/2)-12;this.m_dcon.style.top=(tp<0?0:tp)+p;this.m_dcon.style.left=(lt<0?0:lt)+p;this.m_dcon.style.width=wd+p;this.inf(h);this.m_dcon.style.display=b;return false}CDialog.prototype.hide=function(){this.hm()}CDialog.prototype.hm=function(){var v='visible';var n='none';this.overlay.style.display=n;this.m_dcon.style.display=n;this.inf(v);if(this.m_cleardv){try{this.m_bodycon.removeChild(this.m_cleardv)}catch(e){}this.m_cleardv=null}if(this.m_titlecon){this.m_titlecon.style.display=n}}CDialog.prototype.initdlg=function(){var ab='absolute';var n='none';var obody=ALib.m_document.getElementsByTagName('body')[0];var frag=ALib.m_document.createDocumentFragment();this.overlay=ALib.Dom.getElementById('CDialogOverlay');if(!this.overlay){this.overlay=ALib.Dom.createElement('div');this.overlay.setAttribute('id','CDialogOverlay');ALib.Dom.styleSet(this.overlay,"display","none");ALib.Dom.styleSet(this.overlay,"position","absolute");ALib.Dom.styleSet(this.overlay,"top","0");ALib.Dom.styleSet(this.overlay,"left","0");this.overlay.style.zIndex="998";ALib.Dom.styleSet(this.overlay,"width","100%");obody.appendChild(this.overlay)}this.m_dcon=ALib.Dom.createElement('div');ALib.Dom.setClass(this.m_dcon,"CDialogCon");ALib.Dom.styleSet(this.m_dcon,"display","none");ALib.Dom.styleSet(this.m_dcon,"position","absolute");this.m_dcon.style.zIndex="999";if(!this.m_titlecon){this.m_titlecon=ALib.Dom.createElement("div");this.m_dcon.appendChild(this.m_titlecon);ALib.Dom.setClass(this.m_titlecon,"CDialogTitle");this.m_titlecon.style.display=n}if(this.m_title){this.m_titlecon.innerHTML=this.m_title;this.m_titlecon.style.display="block"}this.m_bodycon=ALib.Dom.createElement("div");this.m_dcon.appendChild(this.m_bodycon);ALib.Dom.setClass(this.m_bodycon,"CDialogBody");obody.appendChild(this.m_dcon);this.m_initialized=true}CDialog.prototype.messageBox=function(msg){if(!this.m_initialized)this.initdlg();var dlg=this;var dv=ALib.Dom.createElement("div");this.m_bodycon.appendChild(dv);var dv_inner=ALib.Dom.createElement("div");ALib.Dom.styleSet(dv_inner,"text-align","center");dv.appendChild(dv_inner);var sp=ALib.Dom.createElement("div");dv_inner.appendChild(sp);sp.innerHTML=msg;var bdv=ALib.Dom.createElement("div");bdv.setAttribute("align","center");dv_inner.appendChild(bdv);var dlg_btn=new CButton("OK",function(dlg){dlg.hm()},[dlg],"b1");dlg_btn.print(bdv);var len=msg.length*10;this.sm(len,50);this.m_cleardv=dv}CDialog.prototype.confirmBox=function(msg,title,args){if(!this.m_initialized)this.initdlg();if(title){this.m_titlecon.innerHTML=title;this.m_titlecon.style.display="block"}var dlg=this;var dv=ALib.Dom.createElement("div");this.m_bodycon.appendChild(dv);var dv_inner=ALib.Dom.createElement("div");ALib.Dom.styleSet(dv_inner,"text-align","center");dv.appendChild(dv_inner);var sp=ALib.Dom.createElement("div");dv_inner.appendChild(sp);sp.innerHTML=msg;var bdv=ALib.Dom.createElement("div");bdv.setAttribute("align","center");dv_inner.appendChild(bdv);function yesClicked(){dlg.hide();if(args){switch(args.length){case 1:dlg.onConfirmOk(args[0]);break;case 2:dlg.onConfirmOk(args[0],args[1]);break;case 3:dlg.onConfirmOk(args[0],args[1],args[2]);break;case 4:dlg.onConfirmOk(args[0],args[1],args[2],args[3]);break;case 5:dlg.onConfirmOk(args[0],args[1],args[2],args[3],args[4]);break;case 6:dlg.onConfirmOk(args[0],args[1],args[2],args[3],args[4],args[5]);break}}else dlg.onConfirmOk();dlg.onConfirmOk=new Function()}var dlg_btn=new CButton("Yes",yesClicked,null,"b1");dlg_btn.print(bdv);function noClicked(){dlg.hide();if(args){switch(args.length){case 1:dlg.onConfirmCancel(args[0]);break;case 2:dlg.onConfirmCancel(args[0],args[1]);break;case 3:dlg.onConfirmCancel(args[0],args[1],args[2]);break;case 4:dlg.onConfirmCancel(args[0],args[1],args[2],args[3]);break;case 5:dlg.onConfirmCancel(args[0],args[1],args[2],args[3],args[4]);break;case 6:dlg.onConfirmCancel(args[0],args[1],args[2],args[3],args[4],args[5]);break}}else dlg.onConfirmCancel();dlg.onConfirmCancel=new Function()}var dlg_btn=new CButton("No",noClicked,null,"b1");dlg_btn.print(bdv);var len=msg.length*10;this.sm(len,50);this.m_cleardv=dv}CDialog.prototype.onConfirmOk=function(){}CDialog.prototype.onConfirmCancel=function(){}CDialog.prototype.customDialog=function(con,width,height){if(!this.m_initialized)this.initdlg();if(this.m_title){this.m_titlecon.innerHTML=this.m_title;this.m_titlecon.style.display="block"}var dlg=this;con.m_dialog=dlg;this.m_bodycon.appendChild(con);this.m_cleardv=con;this.sm(width,height)}CDialog.prototype.statusDialog=function(con,width,height){if(!this.m_initialized)this.initdlg();ALib.Dom.setClass(this.m_bodycon,"");ALib.Dom.setClass(this.m_dcon,"");var dlg=this;con.m_dialog=dlg;this.m_bodycon.appendChild(con);this.m_cleardv=con;this.sm(width,height)}function CRte(){this.ifrm=ALib.Dom.createElement("iframe");this.ifrm.border='0';this.ifrm.frameBorder='0';ALib.Dom.styleSetClass(this.ifrm,"CRteIframe");this.hdntxt=ALib.Dom.createElement("input");this.hdntxt.type="hidden";this.idoc=null;this.f_src=false;this.rte_id='1'}CRte.prototype.setDocument=function(){this.iwnd=this.ifrm.contentWindow||this.ifrm.contentDocument;if(this.iwnd.document){this.idoc=this.iwnd.document}}CRte.prototype.updateText=function(html){if(this.f_src){if(ALib.Dom.m_binfo.ie){var output=escape(this.idoc.body.innerText);output=output.replace("%3CP%3E%0D%0A%3CHR%3E","%3CHR%3E");output=output.replace("%3CHR%3E%0D%0A%3C/P%3E","%3CHR%3E");this.hdntxt.value=unescape(output)}else{var htmlSrc=this.idoc.body.ownerDocument.createRange();htmlSrc.selectNodeContents(this.idoc.body);this.hdntxt.value=htmlSrc.toString()}}else{this.hdntxt.value=this.idoc.body.innerHTML}}CRte.prototype.getValue=function(html){this.updateText();return this.hdntxt.value}CRte.prototype.setHeight=function(height){this.ifrm.style.height=height}CRte.prototype.insertHtml=function(html){if(ALib.Dom.m_binfo.ie){var sel=this.idoc.selection;if(sel!=null){var newRng=sel.createRange();newRng=rng;newRng.select()}this.rteCommand('paste',html)}else{this.rteCommand('insertHtml',html)}}CRte.prototype.enableDesign=function(html){this.setDocument();var frameHtml="<!DOCTYPE html PUBLIC ";frameHtml+='"-//W3C//DTD XHTML 1.0 Strict//EN" ';frameHtml+='"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';frameHtml+="\n";frameHtml="<html id=\""+this.rte_id+"\">\n";frameHtml+="<head>\n";frameHtml+="<meta HTTP-EQUIV='content-type' CONTENT='text/html; charset=UTF-8'>\n";frameHtml+="<style>\n";frameHtml+="body {\n";frameHtml+=" background: #FFFFFF;\n";frameHtml+=" margin: 0px;\n";frameHtml+=" padding: 3px;\n";frameHtml+="}\n";frameHtml+=" P {margin-top:0;margin-bottom:0}\n";frameHtml+="</style>\n";frameHtml+="</head>\n";frameHtml+="<body>\n";if(html)frameHtml+=html+"\n";frameHtml+="</body>\n";frameHtml+="</html>";if(ALib.Dom.m_binfo.ie){this.idoc.open();this.idoc.write(frameHtml);this.idoc.close();this.idoc.designMode="On"}else{this.ifrm.contentDocument.designMode="on";var oRTE=this.ifrm.contentWindow.document;oRTE.open();oRTE.write(frameHtml);oRTE.close();if(ALib.Dom.m_binfo.gecko){oRTE.body.spellcheck=true}}}CRte.prototype.createToolbar=function(container){var me=this;var imgroot=(typeof ALIB_ROOT=="string")?ALIB_ROOT:".";var tb=new CToolbar();tb.setClass("");tb.addIcon(imgroot+"/images/bold.gif","left",function(cls){cls.rteCommand('bold','')},[me]);tb.addIcon(imgroot+"/images/italic.gif","left",function(cls){cls.rteCommand('italic','')},[me]);tb.addIcon(imgroot+"/images/underline.gif","left",function(cls){cls.rteCommand('underline','')},[me]);tb.addSpacer();tb.addIcon(imgroot+"/images/left_just.gif","left",function(cls){cls.rteCommand('justifyleft','')},[me]);tb.addIcon(imgroot+"/images/centre.gif","left",function(cls){cls.rteCommand('justifycenter','')},[me]);tb.addIcon(imgroot+"/images/right_just.gif","left",function(cls){cls.rteCommand('justifyright','')},[me]);tb.addIcon(imgroot+"/images/justifyfull.gif","left",function(cls){cls.rteCommand('justifyfull','')},[me]);tb.addSpacer();tb.addIcon(imgroot+"/images/hr.gif","left",function(cls){cls.rteCommand('inserthorizontalrule','')},[me]);tb.addSpacer();tb.addIcon(imgroot+"/images/numbered_list.gif","left",function(cls){cls.rteCommand('insertorderedlist','')},[me]);tb.addIcon(imgroot+"/images/list.gif","left",function(cls){cls.rteCommand('insertunorderedlist','')},[me]);tb.addSpacer();tb.addIcon(imgroot+"/images/src.gif","left",function(cls){cls.toggleHtmlSrc()},[me]);tb.print(container)}CRte.prototype.rteCommand=function(command,option){var oRTE;if(ALib.Dom.m_binfo.ie){oRTE=this.ifrm}else{oRTE=this.ifrm.contentWindow}try{oRTE.focus();this.idoc.execCommand(command,false,option);oRTE.focus()}catch(e){alert(e)}}CRte.prototype.toggleHtmlSrc=function(){if(this.f_src){if(ALib.Dom.m_binfo.ie){var output=escape(this.idoc.body.innerText);output=output.replace("%3CP%3E%0D%0A%3CHR%3E","%3CHR%3E");output=output.replace("%3CHR%3E%0D%0A%3C/P%3E","%3CHR%3E");this.idoc.body.innerHTML=unescape(output)}else{var htmlSrc=this.idoc.body.ownerDocument.createRange();htmlSrc.selectNodeContents(this.idoc.body);this.idoc.body.innerHTML=htmlSrc.toString()}this.f_src=false}else{if(ALib.Dom.m_binfo.ie){this.idoc.body.innerText=this.idoc.body.innerHTML}else{var htmlSrc=this.idoc.createTextNode(this.idoc.body.innerHTML);this.idoc.body.innerHTML="";this.idoc.body.appendChild(htmlSrc)}this.f_src=true}}CRte.prototype.print=function(container,width,height,html){if(container){this.createToolbar(container);container.appendChild(this.ifrm);if(width)this.ifrm.style.width=width;if(height)this.ifrm.style.height=height;var htm=(typeof html!='undefined')?html:'';this.enableDesign(htm);var me=this;var bcb=function(){me.updateText()}if(ALib.Dom.m_binfo.ie)this.ifrm.attachEvent("onblur",bcb);else this.ifrm.contentDocument.addEventListener("blur",bcb,false);var br=ALib.Dom.createElement("br");container.appendChild(br);container.appendChild(this.hdntxt)}}function CEffect(){this.m_browser=null}CEffect.prototype.round=function(element,sizex,sizey,sizex_b,sizex_y){if(typeof(element)=="string")element=ALib.Dom.getElementById(element);if(typeof(sizey)=='undefined')sizey=sizex;if(typeof(sizex_b)=='undefined')sizex_b=sizex;if(typeof(sizex_y)=='undefined')sizex_y=sizey;var settings={tl:{radius:sizex},tr:{radius:sizey},bl:{radius:sizex_b},br:{radius:sizex_y},antiAlias:true,autoPad:true,validTags:["div"]}var myBoxObject=new curvyCorners(settings,element);myBoxObject.applyCornersToAll()}CEffect.prototype.fadein=function(element,time_ms,max,min){if(typeof(element)=="string")element=ALib.Dom.getElementById(element);if(typeof(max)=="undefined")var max=100;if(typeof(min)=="undefined")var min=0;element.style.opacity='0';element.style.filter='alpha(opacity = '+'0'+')';element.FadeState=-2;this.fade(element,time_ms,max,min)}CEffect.prototype.fadeout=function(element,time_ms,max,min){if(typeof(element)=="string")element=ALib.Dom.getElementById(element);if(typeof(max)=="undefined")var max=100;if(typeof(min)=="undefined")var min=0;element.FadeState=2;this.fade(element,time_ms,max,min)}CEffect.prototype.fade=function(element,time_ms,max,min){if(typeof(element)=="string")element=ALib.Dom.getElementById(element);if(typeof(max)=="undefined")var max=1;if(typeof(min)=="undefined")var min=0;if(element==null)return;if(element.FadeState==null){if(element.style.opacity==null||element.style.opacity==''||element.style.opacity=='1'){element.FadeState=2}else{element.FadeState=-2}}element.animateFade=function(lastTick){var curTick=new Date().getTime();var elapsedTicks=curTick-lastTick;var element=this;if(element.FadeTimeLeft<=elapsedTicks){element.style.opacity=element.FadeState==1?max:min;element.style.filter='alpha(opacity = '+(element.FadeState==1?max:min)+')';element.FadeState=element.FadeState==1?2:-2;return}element.FadeTimeLeft-=elapsedTicks;var newOpVal=element.FadeTimeLeft/time_ms;if(element.FadeState==1)newOpVal=max-newOpVal;element.style.opacity=newOpVal;element.style.filter='alpha(opacity = '+(newOpVal*100)+')';setTimeout(function(){element.animateFade(curTick)},33)}if(element.FadeState==1||element.FadeState==-1){element.FadeState=element.FadeState==1?-1:1;element.FadeTimeLeft=time_ms-element.FadeTimeLeft}else{element.FadeState=element.FadeState==2?-1:1;element.FadeTimeLeft=time_ms;setTimeout(function(){element.animateFade(new Date().getTime())},33)}}var isIE=navigator.userAgent.toLowerCase().indexOf("msie")>-1;var isMoz=document.implementation&&document.implementation.createDocument;var isSafari=((navigator.userAgent.toLowerCase().indexOf('safari')!=-1)&&(navigator.userAgent.toLowerCase().indexOf('mac')!=-1))?true:false;function curvyCorners(){if(typeof(arguments[0])!="object")throw newCurvyError("First parameter of curvyCorners() must be an object.");if(typeof(arguments[1])!="object"&&typeof(arguments[1])!="string")throw newCurvyError("Second parameter of curvyCorners() must be an object or a class name.");if(typeof(arguments[1])=="string"){var startIndex=0;var boxCol=getElementsByClass(arguments[1])}else{var startIndex=1;var boxCol=arguments}var curvyCornersCol=new Array();if(arguments[0].validTags)var validElements=arguments[0].validTags;else var validElements=["div"];for(var i=startIndex,j=boxCol.length;i<j;i++){var currentTag=boxCol[i].tagName.toLowerCase();if(inArray(validElements,currentTag)!==false){curvyCornersCol[curvyCornersCol.length]=new curvyObject(arguments[0],boxCol[i])}}this.objects=curvyCornersCol;this.applyCornersToAll=function(){for(var x=0,k=this.objects.length;x<k;x++){this.objects[x].applyCorners()}}}function curvyObject(){this.box=arguments[1];this.settings=arguments[0];this.topContainer=null;this.bottomContainer=null;this.masterCorners=new Array();this.contentDIV=null;var boxHeight=get_style(this.box,"height","height");var boxWidth=get_style(this.box,"width","width");var borderWidth=get_style(this.box,"borderTopWidth","border-top-width");var borderColour=get_style(this.box,"borderTopColor","border-top-color");var boxColour=get_style(this.box,"backgroundColor","background-color");var backgroundImage=get_style(this.box,"backgroundImage","background-image");var boxPosition=get_style(this.box,"position","position");var boxPadding=get_style(this.box,"paddingTop","padding-top");this.boxHeight=parseInt(((boxHeight&&boxHeight!=""&&boxHeight!="auto"&&boxHeight.indexOf("%")==-1)?boxHeight.substring(0,boxHeight.indexOf("px")):this.box.scrollHeight));this.boxWidth=parseInt(((boxWidth!=""&&boxWidth!="auto"&&boxWidth.indexOf("%")==-1)?boxWidth.substring(0,boxWidth.indexOf("px")):this.box.scrollWidth));this.borderWidth=parseInt(((borderWidth&&borderWidth!=""&&borderWidth.indexOf("px")!==-1)?borderWidth.slice(0,borderWidth.indexOf("px")):0));this.boxColour=format_colour(boxColour);this.boxPadding=parseInt(((boxPadding&&boxPadding!=""&&boxPadding.indexOf("px")!==-1)?boxPadding.slice(0,boxPadding.indexOf("px")):0));this.borderColour=format_colour(borderColour);this.borderString=this.borderWidth+"px"+" solid "+this.borderColour;this.backgroundImage=((backgroundImage!="none")?backgroundImage:"");this.boxContent=this.box.innerHTML;if(boxPosition!="absolute")this.box.style.position="relative";this.box.style.padding="0px";if(isIE&&boxWidth=="auto"&&boxHeight=="auto")this.box.style.width="100%";if(this.settings.autoPad==true&&this.boxPadding>0)this.box.innerHTML="";this.applyCorners=function(){for(var t=0;t<2;t++){switch(t){case 0:if(this.settings.tl||this.settings.tr){var newMainContainer=ALib.Dom.createElement("DIV");newMainContainer.style.width="100%";newMainContainer.style.fontSize="1px";newMainContainer.style.overflow="hidden";newMainContainer.style.position="absolute";newMainContainer.style.paddingLeft=this.borderWidth+"px";newMainContainer.style.paddingRight=this.borderWidth+"px";var topMaxRadius=Math.max(this.settings.tl?this.settings.tl.radius:0,this.settings.tr?this.settings.tr.radius:0);newMainContainer.style.height=topMaxRadius+"px";newMainContainer.style.top=0-topMaxRadius+"px";newMainContainer.style.left=0-this.borderWidth+"px";this.topContainer=this.box.appendChild(newMainContainer)}break;case 1:if(this.settings.bl||this.settings.br){var newMainContainer=ALib.Dom.createElement("DIV");newMainContainer.style.width="100%";newMainContainer.style.fontSize="1px";newMainContainer.style.overflow="hidden";newMainContainer.style.position="absolute";newMainContainer.style.paddingLeft=this.borderWidth+"px";newMainContainer.style.paddingRight=this.borderWidth+"px";var botMaxRadius=Math.max(this.settings.bl?this.settings.bl.radius:0,this.settings.br?this.settings.br.radius:0);newMainContainer.style.height=botMaxRadius+"px";newMainContainer.style.bottom=0-botMaxRadius+"px";newMainContainer.style.left=0-this.borderWidth+"px";this.bottomContainer=this.box.appendChild(newMainContainer)}break}}if(this.topContainer)this.box.style.borderTopWidth="0px";if(this.bottomContainer)this.box.style.borderBottomWidth="0px";var corners=["tr","tl","br","bl"];for(var i in corners){if(i>-1<4){var cc=corners[i];if(!this.settings[cc]){if(((cc=="tr"||cc=="tl")&&this.topContainer!=null)||((cc=="br"||cc=="bl")&&this.bottomContainer!=null)){var newCorner=ALib.Dom.createElement("DIV");newCorner.style.position="relative";newCorner.style.fontSize="1px";newCorner.style.overflow="hidden";if(this.backgroundImage=="")newCorner.style.backgroundColor=this.boxColour;else newCorner.style.backgroundImage=this.backgroundImage;switch(cc){case"tl":newCorner.style.height=topMaxRadius-this.borderWidth+"px";newCorner.style.marginRight=this.settings.tr.radius-(this.borderWidth*2)+"px";newCorner.style.borderLeft=this.borderString;newCorner.style.borderTop=this.borderString;newCorner.style.left=-this.borderWidth+"px";break;case"tr":newCorner.style.height=topMaxRadius-this.borderWidth+"px";newCorner.style.marginLeft=this.settings.tl.radius-(this.borderWidth*2)+"px";newCorner.style.borderRight=this.borderString;newCorner.style.borderTop=this.borderString;newCorner.style.backgroundPosition="-"+(topMaxRadius+this.borderWidth)+"px 0px";newCorner.style.left=this.borderWidth+"px";break;case"bl":newCorner.style.height=botMaxRadius-this.borderWidth+"px";newCorner.style.marginRight=this.settings.br.radius-(this.borderWidth*2)+"px";newCorner.style.borderLeft=this.borderString;newCorner.style.borderBottom=this.borderString;newCorner.style.left=-this.borderWidth+"px";newCorner.style.backgroundPosition="-"+(this.borderWidth)+"px -"+(this.boxHeight+(botMaxRadius+this.borderWidth))+"px";break;case"br":newCorner.style.height=botMaxRadius-this.borderWidth+"px";newCorner.style.marginLeft=this.settings.bl.radius-(this.borderWidth*2)+"px";newCorner.style.borderRight=this.borderString;newCorner.style.borderBottom=this.borderString;newCorner.style.left=this.borderWidth+"px"newCorner.style.backgroundPosition="-"+(botMaxRadius+this.borderWidth)+"px -"+(this.boxHeight+(botMaxRadius+this.borderWidth))+"px";break}}}else{if(this.masterCorners[this.settings[cc].radius]){var newCorner=this.masterCorners[this.settings[cc].radius].cloneNode(true)}else{var newCorner=ALib.Dom.createElement("DIV");newCorner.style.height=this.settings[cc].radius+"px";newCorner.style.width=this.settings[cc].radius+"px";newCorner.style.position="absolute";newCorner.style.fontSize="1px";newCorner.style.overflow="hidden";var borderRadius=parseInt(this.settings[cc].radius-this.borderWidth);for(var intx=0,j=this.settings[cc].radius;intx<j;intx++){if((intx+1)>=borderRadius)var y1=-1;else var y1=(Math.floor(Math.sqrt(Math.pow(borderRadius,2)-Math.pow((intx+1),2)))-1);if(borderRadius!=j){if((intx)>=borderRadius)var y2=-1;else var y2=Math.ceil(Math.sqrt(Math.pow(borderRadius,2)-Math.pow(intx,2)));if((intx+1)>=j)var y3=-1;else var y3=(Math.floor(Math.sqrt(Math.pow(j,2)-Math.pow((intx+1),2)))-1)}if((intx)>=j)var y4=-1;else var y4=Math.ceil(Math.sqrt(Math.pow(j,2)-Math.pow(intx,2)));if(y1>-1)this.drawPixel(intx,0,this.boxColour,100,(y1+1),newCorner,-1,this.settings[cc].radius);if(borderRadius!=j){for(var inty=(y1+1);inty<y2;inty++){if(this.settings.antiAlias){if(this.backgroundImage!=""){var borderFract=(pixelFraction(intx,inty,borderRadius)*100);if(borderFract<30){this.drawPixel(intx,inty,this.borderColour,100,1,newCorner,0,this.settings[cc].radius)}else{this.drawPixel(intx,inty,this.borderColour,100,1,newCorner,-1,this.settings[cc].radius)}}else{var pixelcolour=BlendColour(this.boxColour,this.borderColour,pixelFraction(intx,inty,borderRadius));this.drawPixel(intx,inty,pixelcolour,100,1,newCorner,0,this.settings[cc].radius,cc)}}}if(this.settings.antiAlias){if(y3>=y2){if(y2==-1)y2=0;this.drawPixel(intx,y2,this.borderColour,100,(y3-y2+1),newCorner,0,0)}}else{if(y3>=y1){this.drawPixel(intx,(y1+1),this.borderColour,100,(y3-y1),newCorner,0,0)}}var outsideColour=this.borderColour}else{var outsideColour=this.boxColour;var y3=y1}if(this.settings.antiAlias){for(var inty=(y3+1);inty<y4;inty++){this.drawPixel(intx,inty,outsideColour,(pixelFraction(intx,inty,j)*100),1,newCorner,((this.borderWidth>0)?0:-1),this.settings[cc].radius)}}}this.masterCorners[this.settings[cc].radius]=newCorner.cloneNode(true)}if(cc!="br"){for(var t=0,k=newCorner.childNodes.length;t<k;t++){var pixelBar=newCorner.childNodes[t];var pixelBarTop=parseInt(pixelBar.style.top.substring(0,pixelBar.style.top.indexOf("px")));var pixelBarLeft=parseInt(pixelBar.style.left.substring(0,pixelBar.style.left.indexOf("px")));var pixelBarHeight=parseInt(pixelBar.style.height.substring(0,pixelBar.style.height.indexOf("px")));if(cc=="tl"||cc=="bl"){pixelBar.style.left=this.settings[cc].radius-pixelBarLeft-1+"px"}if(cc=="tr"||cc=="tl"){pixelBar.style.top=this.settings[cc].radius-pixelBarHeight-pixelBarTop+"px"}switch(cc){case"tr":pixelBar.style.backgroundPosition="-"+Math.abs((this.boxWidth-this.settings[cc].radius+this.borderWidth)+pixelBarLeft)+"px -"+Math.abs(this.settings[cc].radius-pixelBarHeight-pixelBarTop-this.borderWidth)+"px";break;case"tl":pixelBar.style.backgroundPosition="-"+Math.abs((this.settings[cc].radius-pixelBarLeft-1)-this.borderWidth)+"px -"+Math.abs(this.settings[cc].radius-pixelBarHeight-pixelBarTop-this.borderWidth)+"px";break;case"bl":pixelBar.style.backgroundPosition="-"+Math.abs((this.settings[cc].radius-pixelBarLeft-1)-this.borderWidth)+"px -"+Math.abs((this.boxHeight+this.settings[cc].radius+pixelBarTop)-this.borderWidth)+"px";break}}}}if(newCorner){switch(cc){case"tl":if(newCorner.style.position=="absolute")newCorner.style.top="0px";if(newCorner.style.position=="absolute")newCorner.style.left="0px";if(this.topContainer)this.topContainer.appendChild(newCorner);break;case"tr":if(newCorner.style.position=="absolute")newCorner.style.top="0px";if(newCorner.style.position=="absolute")newCorner.style.right="0px";if(this.topContainer)this.topContainer.appendChild(newCorner);break;case"bl":if(newCorner.style.position=="absolute")newCorner.style.bottom="0px";if(newCorner.style.position=="absolute")newCorner.style.left="0px";if(this.bottomContainer)this.bottomContainer.appendChild(newCorner);break;case"br":if(newCorner.style.position=="absolute")newCorner.style.bottom="0px";if(newCorner.style.position=="absolute")newCorner.style.right="0px";if(this.bottomContainer)this.bottomContainer.appendChild(newCorner);break}}}}var radiusDiff=new Array();radiusDiff["t"]=Math.abs(this.settings.tl.radius-this.settings.tr.radius)radiusDiff["b"]=Math.abs(this.settings.bl.radius-this.settings.br.radius);for(z in radiusDiff){if(z=="t"||z=="b"){if(radiusDiff[z]){var smallerCornerType=((this.settings[z+"l"].radius<this.settings[z+"r"].radius)?z+"l":z+"r");var newFiller=ALib.Dom.createElement("DIV");newFiller.style.height=radiusDiff[z]+"px";newFiller.style.width=this.settings[smallerCornerType].radius+"px"newFiller.style.position="absolute";newFiller.style.fontSize="1px";newFiller.style.overflow="hidden";newFiller.style.backgroundColor=this.boxColour;switch(smallerCornerType){case"tl":newFiller.style.bottom="0px";newFiller.style.left="0px";newFiller.style.borderLeft=this.borderString;this.topContainer.appendChild(newFiller);break;case"tr":newFiller.style.bottom="0px";newFiller.style.right="0px";newFiller.style.borderRight=this.borderString;this.topContainer.appendChild(newFiller);break;case"bl":newFiller.style.top="0px";newFiller.style.left="0px";newFiller.style.borderLeft=this.borderString;this.bottomContainer.appendChild(newFiller);break;case"br":newFiller.style.top="0px";newFiller.style.right="0px";newFiller.style.borderRight=this.borderString;this.bottomContainer.appendChild(newFiller);break}}var newFillerBar=ALib.Dom.createElement("DIV");newFillerBar.style.position="relative";newFillerBar.style.fontSize="1px";newFillerBar.style.overflow="hidden";newFillerBar.style.backgroundColor=this.boxColour;newFillerBar.style.backgroundImage=this.backgroundImage;switch(z){case"t":if(this.topContainer){if(this.settings.tl.radius&&this.settings.tr.radius){newFillerBar.style.height=topMaxRadius-this.borderWidth+"px";newFillerBar.style.marginLeft=this.settings.tl.radius-this.borderWidth+"px";newFillerBar.style.marginRight=this.settings.tr.radius-this.borderWidth+"px";newFillerBar.style.borderTop=this.borderString;if(this.backgroundImage!="")newFillerBar.style.backgroundPosition="-"+(topMaxRadius+this.borderWidth)+"px 0px";this.topContainer.appendChild(newFillerBar)}this.box.style.backgroundPosition="0px -"+(topMaxRadius-this.borderWidth)+"px"}break;case"b":if(this.bottomContainer){if(this.settings.bl.radius&&this.settings.br.radius){newFillerBar.style.height=botMaxRadius-this.borderWidth+"px";newFillerBar.style.marginLeft=this.settings.bl.radius-this.borderWidth+"px";newFillerBar.style.marginRight=this.settings.br.radius-this.borderWidth+"px";newFillerBar.style.borderBottom=this.borderString;if(this.backgroundImage!="")newFillerBar.style.backgroundPosition="-"+(botMaxRadius+this.borderWidth)+"px -"+(this.boxHeight+(topMaxRadius+this.borderWidth))+"px";this.bottomContainer.appendChild(newFillerBar)}}break}}}if(this.settings.autoPad==true&&this.boxPadding>0){var contentContainer=ALib.Dom.createElement("DIV");contentContainer.style.position="relative";contentContainer.innerHTML=this.boxContent;contentContainer.className="autoPadDiv";var topPadding=Math.abs(topMaxRadius-this.boxPadding);var botPadding=Math.abs(botMaxRadius-this.boxPadding);if(topMaxRadius<this.boxPadding)contentContainer.style.paddingTop=topPadding+"px";if(botMaxRadius<this.boxPadding)contentContainer.style.paddingBottom=botMaxRadius+"px";contentContainer.style.paddingLeft=this.boxPadding+"px";contentContainer.style.paddingRight=this.boxPadding+"px";this.contentDIV=this.box.appendChild(contentContainer)}}this.drawPixel=function(intx,inty,colour,transAmount,height,newCorner,image,cornerRadius){var pixel=ALib.Dom.createElement("DIV");pixel.style.height=height+"px";pixel.style.width="1px";pixel.style.position="absolute";pixel.style.fontSize="1px";pixel.style.overflow="hidden";var topMaxRadius=Math.max(this.settings["tr"].radius,this.settings["tl"].radius);if(image==-1&&this.backgroundImage!=""){pixel.style.backgroundImage=this.backgroundImage;pixel.style.backgroundPosition="-"+(this.boxWidth-(cornerRadius-intx)+this.borderWidth)+"px -"+((this.boxHeight+topMaxRadius+inty)-this.borderWidth)+"px"}else{pixel.style.backgroundColor=colour}if(transAmount!=100)setOpacity(pixel,transAmount);pixel.style.top=inty+"px";pixel.style.left=intx+"px";newCorner.appendChild(pixel)}}function BlendColour(Col1,Col2,Col1Fraction){var red1=parseInt(Col1.substr(1,2),16);var green1=parseInt(Col1.substr(3,2),16);var blue1=parseInt(Col1.substr(5,2),16);var red2=parseInt(Col2.substr(1,2),16);var green2=parseInt(Col2.substr(3,2),16);var blue2=parseInt(Col2.substr(5,2),16);if(Col1Fraction>1||Col1Fraction<0)Col1Fraction=1;var endRed=Math.round((red1*Col1Fraction)+(red2*(1-Col1Fraction)));if(endRed>255)endRed=255;if(endRed<0)endRed=0;var endGreen=Math.round((green1*Col1Fraction)+(green2*(1-Col1Fraction)));if(endGreen>255)endGreen=255;if(endGreen<0)endGreen=0;var endBlue=Math.round((blue1*Col1Fraction)+(blue2*(1-Col1Fraction)));if(endBlue>255)endBlue=255;if(endBlue<0)endBlue=0;return"#"+IntToHex(endRed)+IntToHex(endGreen)+IntToHex(endBlue)}function IntToHex(strNum){base=strNum/16;rem=strNum%16;base=base-(rem/16);baseS=MakeHex(base);remS=MakeHex(rem);return baseS+''+remS}function MakeHex(x){if((x>=0)&&(x<=9)){return x}else{switch(x){case 10:return"A";case 11:return"B";case 12:return"C";case 13:return"D";case 14:return"E";case 15:return"F"}}}function pixelFraction(x,y,r){var pixelfraction=0;var xvalues=new Array(1);var yvalues=new Array(1);var point=0;var whatsides="";var intersect=Math.sqrt((Math.pow(r,2)-Math.pow(x,2)));if((intersect>=y)&&(intersect<(y+1))){whatsides="Left";xvalues[point]=0;yvalues[point]=intersect-y;point=point+1}var intersect=Math.sqrt((Math.pow(r,2)-Math.pow(y+1,2)));if((intersect>=x)&&(intersect<(x+1))){whatsides=whatsides+"Top";xvalues[point]=intersect-x;yvalues[point]=1;point=point+1}var intersect=Math.sqrt((Math.pow(r,2)-Math.pow(x+1,2)));if((intersect>=y)&&(intersect<(y+1))){whatsides=whatsides+"Right";xvalues[point]=1;yvalues[point]=intersect-y;point=point+1}var intersect=Math.sqrt((Math.pow(r,2)-Math.pow(y,2)));if((intersect>=x)&&(intersect<(x+1))){whatsides=whatsides+"Bottom";xvalues[point]=intersect-x;yvalues[point]=0}switch(whatsides){case"LeftRight":pixelfraction=Math.min(yvalues[0],yvalues[1])+((Math.max(yvalues[0],yvalues[1])-Math.min(yvalues[0],yvalues[1]))/2);break;case"TopRight":pixelfraction=1-(((1-xvalues[0])*(1-yvalues[1]))/2);break;case"TopBottom":pixelfraction=Math.min(xvalues[0],xvalues[1])+((Math.max(xvalues[0],xvalues[1])-Math.min(xvalues[0],xvalues[1]))/2);break;case"LeftBottom":pixelfraction=(yvalues[0]*xvalues[1])/2;break;default:pixelfraction=1}return pixelfraction}function rgb2Hex(rgbColour){try{var rgbArray=rgb2Array(rgbColour);var red=parseInt(rgbArray[0]);var green=parseInt(rgbArray[1]);var blue=parseInt(rgbArray[2]);var hexColour="#"+IntToHex(red)+IntToHex(green)+IntToHex(blue)}catch(e){alert("There was an error converting the RGB value to Hexadecimal in function rgb2Hex")}return hexColour}function rgb2Array(rgbColour){var rgbValues=rgbColour.substring(4,rgbColour.indexOf(")"));var rgbArray=rgbValues.split(", ");return rgbArray}function setOpacity(obj,opacity){opacity=(opacity==100)?99.999:opacity;if(isSafari&&obj.tagName!="IFRAME"){var rgbArray=rgb2Array(obj.style.backgroundColor);var red=parseInt(rgbArray[0]);var green=parseInt(rgbArray[1]);var blue=parseInt(rgbArray[2]);obj.style.backgroundColor="rgba("+red+", "+green+", "+blue+", "+opacity/100+")"}else if(typeof(obj.style.opacity)!="undefined"){obj.style.opacity=opacity/100}else if(typeof(obj.style.MozOpacity)!="undefined"){obj.style.MozOpacity=opacity/100}else if(typeof(obj.style.filter)!="undefined"){obj.style.filter="alpha(opacity:"+opacity+")"}else if(typeof(obj.style.KHTMLOpacity)!="undefined"){obj.style.KHTMLOpacity=opacity/100}}function inArray(array,value){for(var i=0;i<array.length;i++){if(array[i]===value)return i}return false}function inArrayKey(array,value){for(key in array){if(key===value)return true}return false}function addEvent(elm,evType,fn,useCapture){if(elm.addEventListener){elm.addEventListener(evType,fn,useCapture);return true}else if(elm.attachEvent){var r=elm.attachEvent('on'+evType,fn);return r}else{elm['on'+evType]=fn}}function removeEvent(obj,evType,fn,useCapture){if(obj.removeEventListener){obj.removeEventListener(evType,fn,useCapture);return true}else if(obj.detachEvent){var r=obj.detachEvent("on"+evType,fn);return r}else{alert("Handler could not be removed")}}function format_colour(colour){var returnColour="#ffffff";if(colour!=""&&colour!="transparent"){if(colour.substr(0,3)=="rgb"){returnColour=rgb2Hex(colour)}else if(colour.length==4){returnColour="#"+colour.substring(1,2)+colour.substring(1,2)+colour.substring(2,3)+colour.substring(2,3)+colour.substring(3,4)+colour.substring(3,4)}else{returnColour=colour}}return returnColour}function get_style(obj,property,propertyNS){var ret=ALib.Dom.styleGet(obj,property);if(ret)return ret;else return"";try{if(obj.currentStyle){var returnVal=eval("obj.currentStyle."+property)}else{if(isSafari&&obj.style.display=="none"){obj.style.display="";var wasHidden=true}var returnVal=ALib.m_document.defaultView.getComputedStyle(obj,'').getPropertyValue(propertyNS);if(isSafari&&wasHidden){obj.style.display="none"}}}catch(e){}return returnVal}function getElementsByClass(searchClass,node,tag){var classElements=new Array();if(node==null)node=ALib.m_document;if(tag==null)tag='*';var els=node.getElementsByTagName(tag);var elsLen=els.length;var pattern=new RegExp("(^|\s)"+searchClass+"(\s|$)");for(i=0,j=0;i<elsLen;i++){if(pattern.test(els[i].className)){classElements[j]=els[i];j++}}return classElements}function newCurvyError(errorMessage){return new Error("curvyCorners Error:\n"+errorMessage)}
